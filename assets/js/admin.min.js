!function(m){"use strict";Object.is||(Object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}),"function"!=typeof DataTransfer.prototype.setDragImage&&(DataTransfer.prototype.setDragImage=function(e,t,n){});var e,t,n,i,a=a||function(s){if(!(void 0===s||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=s.document,l=function(){return s.URL||s.webkitURL||s},c=e.createElementNS("http://www.w3.org/1999/xhtml","a"),u="download"in c,p=/constructor/i.test(s.HTMLElement),d=/CriOS\/[\d]+/.test(navigator.userAgent),f=function(e){(s.setImmediate||s.setTimeout)(function(){throw e},0)},t=4e4,g=function(e){setTimeout(function(){"string"==typeof e?l().revokeObjectURL(e):e.remove()},t)},h=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},i=function(e,n,t){t||(e=h(e));var i,a=this,o="application/octet-stream"===e.type,r=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var a=e["on"+t[i]];if("function"==typeof a)try{a.call(e,n||e)}catch(e){f(e)}}}(a,"writestart progress write writeend".split(" "))};if(a.readyState=a.INIT,u)return i=l().createObjectURL(e),void setTimeout(function(){var e,t;c.href=i,c.download=n,e=c,t=new MouseEvent("click"),e.dispatchEvent(t),r(),g(i),a.readyState=a.DONE});!function(){if((d||o&&p)&&s.FileReader){var t=new FileReader;return t.onloadend=function(){var e=d?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");s.open(e,"_blank")||(s.location.href=e),e=void 0,a.readyState=a.DONE,r()},t.readAsDataURL(e),a.readyState=a.INIT}i=i||l().createObjectURL(e),!o&&s.open(i,"_blank")||(s.location.href=i),a.readyState=a.DONE,r(),g(i)}()},e=i.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=h(e)),navigator.msSaveOrOpenBlob(e,t)}:(e.abort=function(){},e.readyState=e.INIT=0,e.WRITING=1,e.DONE=2,e.error=e.onwritestart=e.onprogress=e.onwrite=e.onabort=e.onerror=e.onwriteend=null,function(e,t,n){return new i(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);function o(){var o=1,p=2,n={alight:null,rootScope:null,$audio:null,wpFileFrameImage:null,wpFileFrameImages:null,wpFileFrameFlipSound:null,wpFileFramePDFDocument:null,wp_base_url:null,wp_upload_url:null,wp_plugin_url:null,wp_ajax_url:null,wp_ajax_nonce:null,wp_ajax_action_update:null,wp_ajax_action_get:null,wp_ajax_action_modal:null,wp_ajax_msg_error:null,wp_item_id:null,bookThemes:null,embedCodeWithId:null,embedCodeWithSlug:null,pdfDirty:!1,pdfTimerId:null,pdfLoading:null,pdf:null,pdfPageSize:o,pdfPageCount:0,pdfFirstPage:null,pdfFirstPageViewport:null,pdfFirstPageRatio:0,pdfPageWidth:0,pdfPageHeight:0,pageStatus:new WeakMap,settings:{themeJavaScript:null,themeCSS:null,pdfProgressiveLoading:!1},config:null,ui:{fullscreen:!1,selectedPages:[],activePage:null,editPage:null,editPageZoom:null,mapLayers:null,activeLayer:null,editLayer:{type:null,initX:null,initY:null,lastX:null,lastY:null,centerX:null,centerY:null,rotation:0,layerAngle:null,layerX:null,layerY:null,layerWidth:null,layerHeight:null},activeBookControl:null,editBookControl:null,activeBookmark:null,editBookmark:null,tabs:{general:!0,pages:!1,customCSS:!1,customJS:!1,shortcode:!1},generalTab:{book:!1,container:!0,pdf:!0,zoom:!0,navigation:!0,toolbar:!0,bookmarks:!0},pageTabs:{page:!0,layers:!1,layer:!1},layerTab:{general:!0,data:!0,special:!1}},defaultConfig:{active:!0,title:null,slug:null,bookEngine:"TwoPageFlip",pageWidth:300,pageHeight:360,pageSizeAuto:!0,pageStart:1,pageStartDelay:0,pdfUrl:null,pdfAutoLoad:!0,pdfCoverImage:{url:null},pdfAutoCreatePages:!1,pdfProgressiveLoading:!1,preloadNeighbours:!1,responsive:!0,autoFit:!0,flipSound:!0,flipSoundUrl:null,flipDuration:300,bookTheme:"light",bookClass:null,bookEnginePortrait:null,bookEngineLandscape:null,ratioPortraitToLandscape:1.3,autoWidth:!0,autoHeight:!0,containerHeight:null,containerWidth:null,padding:{top:10,right:10,bottom:10,left:10},perspective:1500,background:{color:null,image:{url:null},size:null,repeat:null,position:null,inline:!0},prevnextButtons:!0,mouseDragNavigation:!0,mousePageClickNavigation:!1,touchNavigation:!0,keyboardNavigation:!0,mouseWheelNavigation:!1,mouseWheelPreventDefault:!1,zoom:1,zoomMax:7,zoomMin:1,zoomStep:.05,zoomFocal:!0,dblClickZoomDefault:!1,mouseWheelZoom:!1,keyboardZoom:!0,pinchZoom:!0,pinchZoomCoef:.005,pageNumbers:!1,pageNumbersFirst:1,pageNumbersHidden:null,pages:[],toolbar:!0,toolbarControls:[{type:"share",active:!0,title:"share",icon:"ipages-icon ipages-icon-share",optional:!1},{type:"outline",active:!1,title:"toggle outline/bookmark",icon:"ipages-icon ipages-icon-outline",optional:!1},{type:"thumbnails",active:!0,title:"toggle thumbnails",icon:"ipages-icon ipages-icon-thumbnails",optional:!1},{type:"gotofirst",active:!1,title:"goto first page",icon:"ipages-icon ipages-icon-gotofirst",optional:!1},{type:"prev",active:!0,title:"prev page",icon:"ipages-icon ipages-icon-prev",optional:!1},{type:"pagenumber",active:!0,title:"goto page number",icon:"ipages-icon ipages-icon-pagenumber",optional:!1},{type:"next",active:!0,title:"next page",icon:"ipages-icon ipages-icon-next",optional:!1},{type:"gotolast",active:!1,title:"goto last page",icon:"ipages-icon ipages-icon-gotolast",optional:!1},{type:"zoom-in",active:!0,title:"zoom in",icon:"ipages-icon ipages-icon-zoom-in",optional:!1},{type:"zoom-out",active:!0,title:"zoom out",icon:"ipages-icon ipages-icon-zoom-out",optional:!1},{type:"zoom-default",active:!1,title:"zoom default",icon:"ipages-icon ipages-icon-zoom-default",optional:!1},{type:"fullscreen",active:!1,title:"toggle fullscreen",icon:"ipages-icon ipages-icon-fullscreen",optional:!1},{type:"sound",active:!1,title:"turn on/off flip sound",icon:"ipages-icon ipages-icon-sound",optional:!1},{type:"download",active:!1,title:"download pdf",icon:"ipages-icon ipages-icon-download",optional:!1}],autoEnableThumbnails:!1,autoEnableOutline:!1,autoEnableShare:!1,bookmarks:[],customCSS:{active:!1,data:null},customJS:{active:!1,data:null}},defaultBookmark:{active:!0,level:0,text:"",link:"",target:"page"},defaultPage:{guid:null,id:null,active:!0,title:null,type:"image",image:{url:null},page:null,showCSSClass:null,hideCSSClass:null,userData:null,layers:[],dirty:!1},defaultLayer:{id:null,type:"image",title:null,x:0,y:0,width:150,height:100,angle:0,lock:!1,visible:!0,link:null,linkNewWindow:!1,userData:null,htmlData:null,class:null,background:{color:null,image:{url:null},size:null,repeat:null,position:null},text:{data:null,color:"#000",size:18,lineHeight:18,align:null,letterSpacing:null,fontFamily:"sans-serif"}},fn:{init:function(a){if(a.fn.enableLoading(a),m("#ipages-app-item").removeAttr("style"),m(window).on("resize",m.proxy(a.fn.onResize,this,a)),a.plan=ipages_flipbook_globals.plan,a.wp_base_url=ipages_flipbook_globals.wp_base_url,a.wp_upload_url=ipages_flipbook_globals.upload_base_url,a.wp_plugin_url=ipages_flipbook_globals.plugin_base_url,a.wp_ajax_url=ipages_flipbook_globals.ajax_url,a.wp_ajax_nonce=ipages_flipbook_globals.ajax_nonce,a.wp_ajax_action_update=ipages_flipbook_globals.ajax_action_update,a.wp_ajax_action_get=ipages_flipbook_globals.ajax_action_get,a.wp_ajax_action_modal=ipages_flipbook_globals.ajax_action_modal,a.wp_ajax_msg_error=ipages_flipbook_globals.ajax_msg_error,a.msg_pro_title=ipages_flipbook_globals.msg_pro_title,a.msg_edit_text=ipages_flipbook_globals.msg_edit_text,a.msg_custom_js_error=ipages_flipbook_globals.msg_custom_js_error,a.wp_item_id=ipages_flipbook_globals.ajax_item_id,ipages_flipbook_globals.config){for(var e=m.extend(!0,{},a.defaultConfig,JSON.parse(ipages_flipbook_globals.config)),t=0;t<e.pages.length;t++){e.pages[t]=m.extend(!0,{},a.defaultPage,e.pages[t]),e.pages[t].guid||(e.pages[t].guid=a.fn.uuid()),e.pages[t].id||(e.pages[t].id=a.fn.uuid(8)),e.pages[t].image.relative&&e.pages[t].image.url&&(e.pages[t].image.url=a.wp_upload_url+e.pages[t].image.url),e.pages[t].pdfPageNumber&&(e.pages[t].page=e.pages[t].pdfPageNumber,e.pdfUrl&&(e.pages[t].type="pdf")),e.pages[t].pdfpage&&(e.pages[t].page=e.pages[t].pdfpage,delete e.pages[t].pdfpage);for(var n=0;n<e.pages[t].layers.length;n++)e.pages[t].layers[n]=m.extend(!0,{},a.defaultLayer,e.pages[t].layers[n]),e.pages[t].layers[n].id||(e.pages[t].layers[n].id=a.fn.uuid(8))}a.config=e}if((a.embedCodeWithId=a.fn.getEmbedCode(a,"id"),a.embedCodeWithSlug=a.fn.getEmbedCode(a,"slug"),ipages_flipbook_globals.settings)&&(e=m.extend(!0,{},JSON.parse(ipages_flipbook_globals.settings))))for(var t in e)a.settings.hasOwnProperty(t)&&(a.settings[t]=e[t]);PDFJS.disableAutoFetch=!0,PDFJS.disableStream=!0,PDFJS.disableRange=!a.settings.pdfProgressiveLoading,PDFJS.externalLinkTarget=PDFJS.LinkTarget.BLANK,a.rootScope.watch("appData.config.pdfUrl",function(e){clearTimeout(a.pdfTimerId),a.pdfTimerId=setTimeout(function(){var n,i;a.pdfLoading&&(a.pdfLoading.destroy(),a.pdfLoading=null),a.pdf&&(a.pdf.destroy(),a.pdf=null),a.pdfPageSize=o,a.pdfPageCount=0,a.pdfFirstPage=null,a.pdfFirstPageViewport=null,a.pdfFirstPageRatio=0,a.pdfPageWidth=0,a.pdfPageHeight=0,null!=e&&(n=m("#ipages-pdf-loader"),(i=n.find(".ipages-pdf-loader-percent")).text("0%"),n.addClass("ipages-active"),a.pdfLoading=PDFJS.getDocument(e),a.pdfLoading.then(function(e){a.pdf=e,a.pdfPageSize=o,a.pdfPageCount=e.numPages,a.pdfFirstPage=null,a.pdfFirstPageViewport=null,a.pdfFirstPageRatio=0,e.getPage(1).then(function(e){function t(){for(var e=0;e<a.config.pages.length;e++)a.config.pages[e].dirty=!a.config.pages[e].dirty;a.rootScope.scan()}a.pdfFirstPage=e,a.pdfFirstPageViewport=e.getViewport(1),a.pdfFirstPageRatio=a.pdfFirstPageViewport.width/a.pdfFirstPageViewport.height,a.pdfPageWidth=parseInt(a.pdfFirstPageViewport.width,10),a.pdfPageHeight=parseInt(a.pdfFirstPageViewport.height,10),1<a.pdf.numPages?a.pdf.getPage(2).then(function(e){e=e.getViewport(1);e.width/e.height>1.5*a.pdfFirstPageRatio&&(a.pdfPageSize=p,a.pdfPageCount=2*a.pdfPageCount-2),t()}):t()}),n.removeClass("ipages-active")},function(e){console.error(e.message);for(var t=0;t<a.config.pages.length;t++)a.config.pages[t].dirty=!a.config.pages[t].dirty;a.rootScope.scan(),a.fn.showNotice(a,e.message,"notice-error"),n.removeClass("ipages-active")}),a.pdfLoading.onProgress=function(e){var t=100*e.loaded/e.total;isNaN(t)?e&&e.loaded?i.text((Math.ceil(e.loaded/1e4)/100).toString()+"Mb"):i.text(""):i.text(t.toString().split(".")[0]+"%")})},1500)}),a.fn.loadBookThemes(a).done(function(e){a.bookThemes=e}).always(function(){a.rootScope.scan(),a.fn.disableLoading(a)})},enableLoading:function(e){m("#ipages-app-item").removeClass("ipages-active")},disableLoading:function(e){setTimeout(function(){m("#ipages-app-item").addClass("ipages-active")},1e3)},loadData:function(i,e,t){var a=m.Deferred();return m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_get,type:e,id:t},success:function(e){e&&e.success?a.resolve(e.data):this.error()},error:function(e,t,n){e=i.wp_ajax_msg_error+(e&&e.status?" "+e.status+" ":"")+(e&&e.statusText?" ("+e.statusText+") ":"");i.fn.showNotice(i,e,"notice-error"),a.resolve(null)}}),a.promise()},loadBookThemes:function(i){var a=m.Deferred();return m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_get,type:"book-themes"},success:function(e){e&&e.success?a.resolve(e.data.list):this.error()},error:function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error"),a.resolve(null)}}),a.promise()},getPluginConfig:function(t){var e={};e.title=t.config.title,e.slug=t.config.slug,e.wp_plugin_url=t.wp_plugin_url,t.config.bookEngine&&(e.bookEngine=t.config.bookEngine),e.bookEnginePortrait=null,e.bookEngineLandscape=null,e.ratioPortraitToLandscape=1.3,e.bookTheme=t.config.bookTheme,e.autoHeight=!1,e.flags={customcss:t.config.customCSS.active},"lite"==t.plan&&(e.contextmenu=!0),e.pageWidth=t.config.pageWidth,e.pageHeight=t.config.pageHeight,e.pageSizeAuto=t.config.pageSizeAuto,e.pageStart=t.config.pageStart,e.pageStartDelay=t.config.pageStartDelay,e.pdfUrl=t.config.pdfUrl,e.pdfAutoLoad=t.config.pdfAutoLoad,e.pdfCoverImageUrl=t.fn.getImageUrl(t,t.config.pdfCoverImage),e.pdfAutoCreatePages=!1,e.pdfDisableRangeRequests=!t.config.pdfProgressiveLoading,e.preloadNeighbours=t.config.preloadNeighbours,e.responsive=t.config.responsive,e.autoFit=t.config.autoFit,e.flipSound=t.config.flipSound,e.flipSoundUrl=t.config.flipSoundUrl,e.perspective=t.config.perspective,e.padding={top:t.config.padding.top,right:t.config.padding.right,bottom:t.config.padding.bottom,left:t.config.padding.left},e.flipDuration=t.config.flipDuration,e.pageNumbers=t.config.pageNumbers,e.pageNumbersFirst=t.config.pageNumbersFirst,e.pageNumbersHidden=t.config.pageNumbersHidden?t.config.pageNumbersHidden.split(";"):[];for(var n=0;n<e.pageNumbersHidden.length;n++)e.pageNumbersHidden[n]=parseInt(e.pageNumbersHidden[n],10);e.prevnextButtons=t.config.prevnextButtons,e.mouseDragNavigation=t.config.mouseDragNavigation,e.mousePageClickNavigation=t.config.mousePageClickNavigation,e.touchNavigation=t.config.touchNavigation,e.keyboardNavigation=t.config.keyboardNavigation,e.mouseWheelNavigation=t.config.mouseWheelNavigation,e.mouseWheelPreventDefault=t.config.mouseWheelPreventDefault,e.zoom=t.config.zoom,e.zoomMax=t.config.zoomMax,e.zoomMin=t.config.zoomMin,e.zoomStep=t.config.zoomStep,e.zoomFocal=t.config.zoomFocal,e.dblClickZoomDefault=t.config.dblClickZoomDefault,e.mouseWheelZoom=t.config.mouseWheelZoom,e.keyboardZoom=t.config.keyboardZoom,e.pinchZoom=t.config.pinchZoom,e.pinchZoomCoef=t.config.pinchZoomCoef,e.toolbar=t.config.toolbar,e.toolbarControls=m.extend(!0,[],t.config.toolbarControls),e.autoEnableThumbnails=t.config.autoEnableThumbnails,e.autoEnableOutline=t.config.autoEnableOutline,e.autoEnableShare=t.config.autoEnableShare,e.bookmarks=[];for(var i=m.extend(!0,[],t.config.bookmarks),n=0;n<i.length;n++){var a=i[n];a.id=n,a.hasOwnProperty("parent")||(a.parent=null);for(var o=n+1;o<i.length;o++){var r=i[o];if(r.level>a.level&&(r.parent=a),r.level<a.level)break}}for(n=0;n<i.length;n++){var s=i[n],l={text:s.text,link:s.link,target:s.target,bookmarks:[]};s.active&&(!function e(t,n,i,a){for(var o,r,s=t+1;s<a.length;s++)a[s].parent&&n.id==a[s].parent.id&&(r={text:(o=a[s]).text,link:o.link,target:o.target,bookmarks:[]},o.active&&(e(s,o,r,a),i.bookmarks.push(r)))}(n,s,l,i),null==s.parent&&e.bookmarks.push(l))}for(var c=[],n=0;n<t.config.pages.length;n++){var u=t.config.pages[n];u.active&&c.push(t.fn.getPluginPageConfig(t,u,e.flags))}if(e.pages=0<c.length?c:[],t.config.customJS.active){e.onLoad=t.config.customJS.data;try{new Function(e.onLoad)}catch(e){t.fn.showNotice(t,t.msg_custom_js_error+": "+e.message,"notice-error")}}return e},getPluginPageConfig:function(e,t,n){var i={};i.id=t.id,i.type=t.type,"image"==i.type&&(i.image=e.fn.getImageUrl(e,t.image)),"pdf"==i.type&&(i.page=t.page),t.showCSSClass&&(i.showCSSClass=t.showCSSClass),t.hideCSSClass&&(i.hideCSSClass=t.hideCSSClass),t.userData&&(i.userData=t.userData);for(var a=[],o=0;o<t.layers.length;o++){var r=t.layers[o];r.visible&&a.push(e.fn.getPluginLayerConfig(e,r))}return a.length&&(i.layers=a),i},getPluginLayerConfig:function(e,t){var n={};return n.id=t.id,n.type=t.type,t.title&&(n.title=t.title),t.link&&(n.link=t.link,n.linkNewWindow=t.linkNewWindow),"text"==t.type&&t.text.data&&(n.text=t.text.data),t.class&&(n.class=t.class),t.userData&&(n.userData=t.userData),t.htmlData&&(n.htmlData=t.htmlData),n},saveConfig:function(i){i.fn.enableLoading(i),i.fn.saveEditorsData(i);var e=m.extend(!0,{},i.config),t=JSON.stringify(e),e=i.fn.getPluginConfig(i),e=JSON.stringify(e);m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_update,type:"config",id:i.wp_item_id,data:t,config:e}}).done(function(e){var t;return e?(e.data&&e.data.id&&((t=new URL(window.location.href)).searchParams.set("id",e.data.id),window.history.replaceState(null,null,t),i.wp_item_id=e.data.id),i.fn.showNotice(i,e.data.msg,e.success?"notice-success":"notice-error"),void i.rootScope.scan()):void i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error")}).fail(function(e,t,n){e=i.wp_ajax_msg_error+(e.status?" "+e.status+" ":"")+(e.statusText?" ("+e.statusText+") ":"");i.fn.showNotice(i,e,"notice-error")}).always(function(){i.fn.disableLoading(i)})},loadConfigFromJson:function(e,t){t&&(t=JSON.parse(t),e.config=m.extend(!0,{},t),e.rootScope.scan())},loadConfigFromFile:function(e){var t=m("#ipages-load-config-from-file").off("change");t.one("change",m.proxy(function(t,e){var n=e.target.files[0];e.target.value="",n&&((e=new FileReader).onload=m.proxy(function(e){e=e.target.result;t.fn.loadConfigFromJson(t,e)},this),e.readAsText(n))},this,e)),t.click()},saveConfigToFile:function(e){var t=m.extend(!0,{},e.config),t=JSON.stringify(t),e=e.wp_item_id?"ipages_config_"+e.wp_item_id+".json":"ipages_config.json",e=new File([t],e,{type:"application/json;charset=utf-8"});a(e)},getPrewiewPageUrl:function(e){return new Url(e.wp_base_url+"/ipages/flipbook/"+e.wp_item_id+"?preview=1").toString()},preview:function(e){window.open(e.fn.getPrewiewPageUrl(e),"_blank")},showNotice:function(e,t,n){var i=m("#ipages-messages"),a=m("<div></div>").addClass("notice is-dismissible").addClass(n),n=m("<p></p>").html(t),t=m("<button></button>").attr("type","button").addClass("notice-dismiss").html('<span class="screen-reader-text">Dismiss this notice.</span>');function o(){clearTimeout(a.data("timer")),a.fadeTo(100,0,function(){a.slideUp(100,function(){a.remove()})})}a.data("timer",setTimeout(o,5e3)),t.click(function(e){e.preventDefault(),o()}),a.append(n,t),i.append(a)},createBlob:function(e,t,n){return new Blob([t],{type:n})},createObjectURL:function(e,t,n){n=e.fn.createBlob(e,t,n);return URL.createObjectURL(n)},getEmbedCode:function(e,t){var n=null;switch(t){case"id":n=new Url(e.wp_base_url+"/ipages/flipbook/"+e.wp_item_id);break;case"slug":n=new Url(e.wp_base_url+"/ipages/flipbook/"+e.config.slug)}return'<iframe width="560" height="315" src="'+n+'" frameborder="0" allowfullscreen></iframe>'},onPageImageUpdate:function(s,l,e,c){var u=m(e),e=s.pageStatus.get(l);function t(){var e;null!=s.pdf&&0<l.page?(e=u.data("update-timer-id"),clearTimeout(e),e=setTimeout(function(){var e=l.page;s.pdfPageSize==p&&2<e&&(e=Math.ceil((e-1)/2)+1),s.pdf.getPage(e).then(function(e){var t=s.pdfPageSize==p&&1<l.page&&l.page<s.pdfPageCount,n="layer"==c?s.config.pageWidth:160,i=e.getViewport(1),a=s.pdfPageSize==p?s.pdfFirstPageRatio:i.width/i.height,i=e.getViewport(n/(s.pdfPageSize==p?s.pdfFirstPageViewport:i).width),o=document.createElement("canvas"),r=o.getContext("2d");o.width=Math.round(n),o.height=Math.round(n/a),t&&l.page%2==1&&(i.transform[4]=-o.width),e.render({canvasContext:r,viewport:i}).then(function(){o.toBlob(function(e){e=s.fn.createObjectURL(s,e,"image/jpeg");u.css("background-image",e="url("+e+")"),u.data("update-timer-id",null),o=null},"image/jpeg",.9),0})},function(e){u.css("background-image","")})},e?1500:1),u.data("update-timer-id",e)):u.css("background-image","")}function n(){var e=s.fn.getImageUrl(s,l.image,"style");u.css("background-image",e)}function i(){u.css("background-image","")}!e||l.page!=e.page||l.dirty!=e.dirty?("pdf"==l.type?t:"image"==l.type?n:i)():l.image.url!=e.image.url&&n(),e={type:l.type,page:l.page,image:{url:l.image.url}},s.pageStatus.set(l,e)},getImageUrl:function(e,t,n){var i=null;return t&&t.url&&0<t.url.length?(i=t.url,"style"==n&&(i="url("+i+")")):"style"==n&&(i="none"),i},selectPost:function(t,n,i){var a={posts:null,selectedPost:null,fn:{onClickPost:function(e,t,n,i){var a=m("#ipages-modal-"+e.id),n=m(n);a.find(".ipages-modal-post.ipages-active").removeClass("ipages-active"),n.addClass("ipages-active"),e.selectedPost=e.fn.getPostUrl(e,i)},onDblClickPost:function(e){e.deferred.resolve(!0)},selectPost:function(e){e.deferred.resolve(!0)},getPostUrl:function(e,t){return t.url},getPostTitle:function(e,t){return t.title}}};t.modal.fn.show(t,"posts",a,t.fn.selectPostCallback).then(function(e){t.modal.fn.close(t,a.id),"close"!=e&&e&&a.selectedPost&&(i.link=a.selectedPost,n.scan())})},selectPostCallback:function(t){t.appData.fn.loadData(n,"posts").done(function(e){t.posts=e.list,t.rootScope.scan(),m("#ipages-modal-"+t.id).find(".ipages-modal-data").removeClass("ipages-modal-loading"),n.modal.fn.resize(t)})},selectImage:function(n,i,a){n.wpFileFrameImage&&(n.wpFileFrameImage.detach(),n.wpFileFrameImage=null),n.wpFileFrameImage=wp.media.frames.file_frame=wp.media({library:{type:["image"]},multiple:!1}),n.wpFileFrameImage.on("select",function(e){var t=n.wpFileFrameImage.state().get("selection").first().toJSON().url;a.url=t,i.scan()}),n.wpFileFrameImage.open()},selectFlipSound:function(n){n.wpFileFrameFlipSound||(n.wpFileFrameFlipSound=wp.media.frames.file_frame=wp.media({library:{type:["audio"]},multiple:!1}),n.wpFileFrameFlipSound.on("select",function(e){var t=n.wpFileFrameFlipSound.state().get("selection").first().toJSON().url;n.config.flipSoundUrl=t,n.rootScope.scan()})),n.wpFileFrameFlipSound.open()},playFlipSound:function(e){if(e.config.flipSoundUrl){if(e.$audio){var t=e.$audio.get(0);try{t.pause(),t.currentTime=0}catch(e){}e.$audio.remove(),e.$audio=null}e.$audio=m("<audio preload></audio>").appendTo(m("body")),e.$audio.append(m("<source>").attr("src",e.config.flipSoundUrl)),e.$audio.get(0).play()}},selectPDFDocument:function(n){n.wpFileFramePDFDocument||(n.wpFileFramePDFDocument=wp.media.frames.file_frame=wp.media({library:{type:["application/pdf"]},multiple:!1}),n.wpFileFramePDFDocument.on("select",function(e){var t=n.wpFileFramePDFDocument.state().get("selection").first().toJSON().url;n.config.pdfUrl!=t&&(n.pdfDirty=!0),n.config.pdfUrl=t,n.rootScope.scan()})),n.wpFileFramePDFDocument.open()},generatePDFPages:function(i){var a;null!=i.pdf&&(a={removeExistingPages:{show:!0,action:!1},pageSize:{show:!0,action:!0,width:i.pdfPageWidth,height:i.pdfPageHeight},createPages:{show:!0,action:!0},easyClose:!1},i.modal.fn.show(i,"pdf-setup",a,null).then(function(e){if(i.modal.fn.close(i,a.id),"close"!=e){if(a.removeExistingPages.action&&(i.config.pages=[],i.ui.activePage=null,i.ui.editPage=null,i.ui.activeLayer=null),a.pageSize.action&&(i.config.pageWidth=i.pdfPageWidth,i.config.pageHeight=i.pdfPageHeight),a.createPages.action){for(var t=0;t<i.pdfPageCount;t++){var n=m.extend(!0,{},i.defaultPage);n.guid=i.fn.uuid(),n.id=i.fn.uuid(8),n.type="pdf",n.page=t+1,i.config.pages.push(n)}i.fn.onTab(i,"pages")}e&&i.rootScope.scan()}}))},hasPdfPages:function(e){for(var t=0;t<e.config.pages.length;t++){var n=e.config.pages[t];if("pdf"==n.type&&n.page)return!0}return!1},addPagesFromMedia:function(o){o.wpFileFrameImages&&(o.wpFileFrameImages.detach(),o.wpFileFrameImages=null),o.wpFileFrameImages=wp.media.frames.file_frame=wp.media({library:{type:["image"]},multiple:!0}),o.wpFileFrameImages.on("select",function(e){for(var t=o.wpFileFrameImages.state().get("selection").toJSON(),n=0;n<t.length;n++){var i=t[n].url,a=m.extend(!0,{},o.defaultPage);a.guid=o.fn.uuid(),a.id=o.fn.uuid(8),a.type="image",a.image.url=i,o.config.pages.push(a)}o.rootScope.scan()}),o.wpFileFrameImages.open()},addPage:function(e){var t=m.extend(!0,{},e.defaultPage);if(t.guid=e.fn.uuid(),t.id=e.fn.uuid(8),e.ui.activePage){for(var n=null,i=e.config.pages.length,a=0;a<i;a++){var o=e.config.pages[a];if(Object.is(e.ui.activePage,o)){n=a;break}}if(e.config.pages.push(t),n+1<i)for(a=i;n+1<a;a--){o=e.config.pages[a];e.config.pages[a]=e.config.pages[a-1],e.config.pages[a-1]=o}}else e.config.pages.push(t);e.fn.selectPage(e,t)},copyPage:function(e){if(null!=e.ui.activePage){for(var t=null,n=e.config.pages.length,i=null,a=0;a<n;a++)if(i=e.config.pages[a],Object.is(e.ui.activePage,i)){t=a;break}null!=t&&((i=m.extend(!0,{},i)).guid=e.fn.uuid(),i.id=e.fn.uuid(8),i.title=(i.title||"")+" [copy]",e.config.pages.splice(t+1,0,i),e.fn.selectPage(e,i))}},updownPage:function(e,t){if(null!=e.ui.activePage){for(var n=null,i=e.config.pages.length,a=null,o=0;o<i;o++)if(a=e.config.pages[o],Object.is(e.ui.activePage,a)){n=o;break}if(null!=n)if("up"==t&&0<n)e.config.pages[n]=e.config.pages[n-1],e.config.pages[n-1]=a;else if("down"==t&&n<i-1)e.config.pages[n]=e.config.pages[n+1],e.config.pages[n+1]=a;else if("start"==t&&0<n)for(o=n;0<o;o--)a=e.config.pages[o],e.config.pages[o]=e.config.pages[o-1],e.config.pages[o-1]=a;else if("end"==t&&n<i-1)for(o=n;o<i-1;o++)a=e.config.pages[o],e.config.pages[o]=e.config.pages[o+1],e.config.pages[o+1]=a}},deletePage:function(e){if(null!=e.ui.activePage){for(var t,n=null,i=e.config.pages.length,a=0;a<i;a++){var o=e.config.pages[a];if(Object.is(e.ui.activePage,o)){n=a;break}}null!=n&&(0<=(t=n)&&n<i&&(e.config.pages.splice(n,1),n==i-1&&1<i?t=i-2:1==i&&(t=null)),e.fn.selectPage(e,e.config.pages[t]))}},isPageActive:function(e,t){return Object.is(e.ui.activePage,t)},selectPage:function(e,t){Object.is(e.ui.activePage,t)?e.ui.activePage=null:e.ui.activePage=t},editPage:function(e,t){Object.is(e.ui.editPage,t)?(e.ui.editPage=null,e.ui.mapLayers&&e.ui.mapLayers.clear(),e.ui.mapLayers=null):(e.ui.activePage=e.ui.editPage=t,e.ui.mapLayers=new Map,e.rootScope.scan(),e.fn.onPageTab(e,"layers"),e.fn.updateEditPageLayout(e))},editPrevNextPage:function(e,t){for(var n=null,i=e.config.pages.length,a=0;a<i;a++)if(Object.is(e.config.pages[a],e.ui.editPage)){n=a;break}"prev"==t&&0<n&&e.fn.editPage(e,e.config.pages[n-1]),"next"==t&&n<i-1&&e.fn.editPage(e,e.config.pages[n+1]),e.rootScope.scan()},getPageNumber:function(e,t){for(var n=null,i=e.config.pages.length,a=0;a<i;a++)if(Object.is(e.config.pages[a],t)){n=a+1;break}return n},updateEditPageLayout:function(e){var t,n,i,a,o,r,s,l=m("#ipages-layer-canvas");0!=l.length&&(t=m("#ipages-layer-page"),n=l.width()-30,i=l.height()-30,a=e.config.pageWidth,o=e.config.pageHeight,s=1,n<=a&&i<=o?s=(r=i/o)<(l=n/a)?r:l:n<=a?s=n/a:i<=o&&(s=i/o),e.ui.editPageZoom=s,t.css({"margin-top":-o/2+"px","margin-left":-a/2+"px",width:a+"px",height:o+"px",transform:"scale("+s+")"}))},saveEditorsData:function(e){var t=m("#ipages-notepad-css");t.length&&(n=ace.edit(t.get(0)),e.config.customCSS.data=n.getSession().getValue());var n=m("#ipages-notepad-js");n.length&&(n=ace.edit(n.get(0)),e.config.customJS.data=n.getSession().getValue())},onTab:function(e,t){if(!e.ui.tabs[t]){var n,i=e.ui.tabs;for(n in i)i.hasOwnProperty(n)&&(i[n]=!1);switch(e.ui.tabs[t]=!0,e.fn.saveEditorsData(e),e.rootScope.scan(),t){case"pages":e.fn.updateEditPageLayout(e);break;case"customCSS":var a=m("#ipages-notepad-css"),a=ace.edit(a.get(0));a.$blockScrolling=1/0,a.setTheme("ace/theme/monokai"),a.session.setMode("ace/mode/css"),e.settings.themeCSS&&a.setTheme("ace/theme/"+e.settings.themeCSS),e.config.customCSS.data&&a.getSession().setValue(e.config.customCSS.data);break;case"customJS":a=m("#ipages-notepad-js"),a=ace.edit(a.get(0));a.$blockScrolling=1/0,a.setTheme("ace/theme/monokai"),a.session.setMode("ace/mode/javascript"),e.settings.themeJavaScript&&a.setTheme("ace/theme/"+e.settings.themeJavaScript),e.config.customJS.data&&a.getSession().setValue(e.config.customJS.data)}}},onPageTab:function(e,t){if(!e.ui.pageTabs[t]){var n,i=e.ui.pageTabs;for(n in i)i.hasOwnProperty(n)&&(i[n]=!1);e.ui.pageTabs[t]=!0}},onGeneralTab:function(e,t){e.ui.generalTab[t]=!e.ui.generalTab[t]},onLayerTab:function(e,t){e.ui.layerTab[t]=!e.ui.layerTab[t]},onResize:function(e,t){e.fn.updateEditPageLayout(e)},onFullScreenChange:function(e,t){document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement?(m("#ipages-app-item").addClass("ipages-fullscreen"),e.ui.fullscreen=!0):(m("#ipages-app-item").removeClass("ipages-fullscreen"),e.ui.fullscreen=!1),e.rootScope.scan()},toggleFullscreen:function(e){if(e.ui.fullscreen)try{document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}catch(e){console.error("The browser does not support the fullscreen API")}else try{var t=m("#ipages-app-item").get(0);t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}catch(e){console.error("The browser does not support the fullscreen API")}},copyToClipboard:function(e,t){var n=m(t);if(0!=n.length){var i=n.val();if(window.clipboardData&&window.clipboardData.setData)return clipboardData.setData("Text",i);if(document.queryCommandSupported&&document.queryCommandSupported("copy")){t=document.createElement("textarea");t.textContent=i,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.warn("Copy to clipboard failed.",e)}finally{document.body.removeChild(t)}}n.select()}},initLayer:function(e,t,n){e.ui.mapLayers.set(t,m(n))},initLayerInner:function(e,t,n){"text"==t.type&&t.text.data&&m(n).html(t.text.data)},selectLayer:function(e,t){e.ui.activeLayer=t},isLayerActive:function(e,t){return Object.is(e.ui.activeLayer,t)},onLayerClick:function(e,t){e.fn.isLayerActive(e,t)||e.fn.selectLayer(e,t)},addLayerImage:function(e){var t;null!=e.ui.activePage&&((t=m.extend(!0,{},e.defaultLayer)).id=e.fn.uuid(8),t.type="image",e.ui.activePage.layers.push(t),e.fn.selectLayer(e,t))},addLayerText:function(e){var t;null!=e.ui.activePage&&((t=m.extend(!0,{},e.defaultLayer)).id=e.fn.uuid(8),t.type="text",t.text.data=e.msg_edit_text,e.ui.activePage.layers.push(t),e.fn.selectLayer(e,t))},copyLayer:function(e){if(null!=e.ui.activeLayer){for(var t=null,n=e.ui.activePage.layers.length,i=null,a=0;a<n;a++)if(i=e.ui.activePage.layers[a],Object.is(e.ui.activeLayer,i)){t=a;break}null!=t&&((i=m.extend(!0,{},i)).id=e.fn.uuid(8),i.title=(i.title||i.type)+" [copy]",e.ui.activePage.layers.splice(t+1,0,i),e.fn.selectLayer(e,i))}},updownLayer:function(e,t){if(null!=e.ui.activeLayer){for(var n=null,i=e.ui.activePage.layers.length,a=null,o=0;o<i;o++)if(a=e.ui.activePage.layers[o],Object.is(e.ui.activeLayer,a)){n=o;break}if(null!=n)if("up"==t&&0<n)e.ui.activePage.layers[n]=e.ui.activePage.layers[n-1],e.ui.activePage.layers[n-1]=a;else if("down"==t&&n<i-1)e.ui.activePage.layers[n]=e.ui.activePage.layers[n+1],e.ui.activePage.layers[n+1]=a;else if("start"==t&&0<n)for(o=n;0<o;o--)a=e.ui.activePage.layers[o],e.ui.activePage.layers[o]=e.ui.activePage.layers[o-1],e.ui.activePage.layers[o-1]=a;else if("end"==t&&n<i-1)for(o=n;o<i-1;o++)a=e.ui.activePage.layers[o],e.ui.activePage.layers[o]=e.ui.activePage.layers[o+1],e.ui.activePage.layers[o+1]=a}},deleteLayer:function(e){if(null!=e.ui.activeLayer){for(var t,n=null,i=e.ui.activePage.layers.length,a=0;a<i;a++){var o=e.ui.activePage.layers[a];if(Object.is(e.ui.activeLayer,o)){n=a;break}}null!=n&&(0<=(t=n)&&n<i&&(e.ui.activePage.layers.splice(n,1),n==i-1&&1<i?t=i-2:1==i&&(t=null)),e.fn.selectLayer(e,e.ui.activePage.layers[t]))}},editLayerAlign:function(e,t){if(null!=e.ui.activeLayer){var n=e.ui.activeLayer;switch(t){case"top":n.y=0;break;case"middle":n.y=e.config.pageHeight/2-n.height/2;break;case"bottom":n.y=e.config.pageHeight-n.height;break;case"left":n.x=0;break;case"center":n.x=e.config.pageWidth/2-n.width/2;break;case"right":n.x=e.config.pageWidth-n.width}}},toggleLayerVisible:function(e,t){t.visible=!t.visible},toggleLayerLock:function(e,t){t.lock=!t.lock},initBookControlIcon:function(e,t,n){t&&m(n).addClass(t.icon)},selectBookControl:function(e,t){e.ui.activeBookControl=t},isBookControlActive:function(e,t){return Object.is(e.ui.activeBookControl,t)},isBookControlEdit:function(e,t){return Object.is(e.ui.editBookControl,t)},toggleBookControlActive:function(e,t){t.active=!t.active},toggleBookControlOptional:function(e,t){t.optional=!t.optional},editBookControlTitle:function(e,t,n){n&&setTimeout(function(){m(n).find(".ipages-text").first().focus()},1),t&&(e.ui.activeBookControl=t),null!=e.ui.activeBookControl&&(e.ui.editBookControl=e.ui.activeBookControl)},updownBookControl:function(e,t){if(null!=e.ui.activeBookControl){for(var n=null,i=e.config.toolbarControls.length,a=null,o=0;o<i;o++)if(a=e.config.toolbarControls[o],Object.is(e.ui.activeBookControl,a)){n=o;break}null!=n&&("up"==t&&0<n?(e.config.toolbarControls[n]=e.config.toolbarControls[n-1],e.config.toolbarControls[n-1]=a):"down"==t&&n<i-1&&(e.config.toolbarControls[n]=e.config.toolbarControls[n+1],e.config.toolbarControls[n+1]=a))}},onBookControlEnter:function(e,t){13==t.which&&(e.ui.editBookControl=null)},getBookmarkLevel:function(e,t){return 20*t.level+"px"},getBookmarkLabel:function(e,t){var n="";return t.text&&(n+=t.text+" "),t.link&&(n+="["+t.link+"]"),n},selectBookmark:function(e,t){e.ui.activeBookmark=t},isBookmarkActive:function(e,t){return Object.is(e.ui.activeBookmark,t)},isBookmarkEdit:function(e,t){return Object.is(e.ui.editBookmark,t)},toggleBookmarkActive:function(e,t){t.active=!t.active},addBookmark:function(e){var t=m.extend(!0,{},e.defaultBookmark);e.config.bookmarks.push(t),e.fn.selectBookmark(e,t)},copyBookmark:function(e){if(null!=e.ui.activeBookmark){for(var t=null,n=e.config.bookmarks.length,i=null,a=0;a<n;a++)if(i=e.config.bookmarks[a],Object.is(e.ui.activeBookmark,i)){t=a;break}null!=t&&((i=m.extend(!0,{},i)).text=i.text+"[copy]",e.config.bookmarks.splice(t+1,0,i),e.fn.selectBookmark(e,i))}},editBookmark:function(e,t,n){n&&setTimeout(function(){m(n).find(".ipages-text").first().focus()},1),t&&(e.ui.activeBookmark=t),null!=e.ui.activeBookmark&&(e.ui.editBookmark=e.ui.activeBookmark)},deleteBookmark:function(e){if(null!=e.ui.activeBookmark){for(var t,n=null,i=e.config.bookmarks.length,a=0;a<i;a++){var o=e.config.bookmarks[a];if(Object.is(e.ui.activeBookmark,o)){n=a;break}}null!=n&&(0<=(t=n)&&n<i&&(e.config.bookmarks.splice(n,1),n==i-1&&1<i?t=i-2:1==i&&(t=null)),e.fn.selectBookmark(e,e.config.bookmarks[t]))}},onBookmarkEnter:function(e,t){13==t.which&&(e.ui.editBookmark=null)},updownBookmark:function(e,t){if(null!=e.ui.activeBookmark){for(var n=null,i=e.config.bookmarks.length,a=null,o=0;o<i;o++)if(a=e.config.bookmarks[o],Object.is(e.ui.activeBookmark,a)){n=o;break}null!=n&&("up"==t&&0<n?(e.config.bookmarks[n]=e.config.bookmarks[n-1],e.config.bookmarks[n-1]=a):"down"==t&&n<i-1&&(e.config.bookmarks[n]=e.config.bookmarks[n+1],e.config.bookmarks[n+1]=a))}},levelBookmark:function(e,t){null!=e.ui.activeBookmark&&("left"==t?--e.ui.activeBookmark.level:"right"==t&&(e.ui.activeBookmark.level+=1),e.ui.activeBookmark.level<0&&(e.ui.activeBookmark.level=0),3<e.ui.activeBookmark.level&&(e.ui.activeBookmark.level=3))},getLayerStyle:function(e,t,n){switch(n){case"x":return t.x+"px";case"y":return t.y+"px";case"width":return t.width+"px";case"height":return t.height+"px";case"angle":return t.angle?"rotate("+t.angle+"deg)":"rotate(0deg)";case"background-color":return"image"==t.type?t.background.color||"":null;case"background-image":return"image"==t.type?e.fn.getImageUrl(e,t.background.image,"style"):null;case"background-size":return"image"==t.type?t.background.size||"":null;case"background-repeat":return"image"==t.type?t.background.repeat||"":null;case"background-position":return"image"==t.type?t.background.position||"":null;case"color":return"text"==t.type?t.text.color:null;case"font-family":return"text"==t.type?t.text.fontFamily||"":null;case"font-size":return"text"==t.type?(0<t.text.size?t.text.size:0)+"px":null;case"line-height":return"text"==t.type?(0<t.text.lineHeight?t.text.lineHeight:0)+"px":null;case"letter-spacing":return"text"==t.type?(0<t.text.letterSpacing?t.text.letterSpacing:0)+"px":null;case"text-align":if("text"==t.type)return t.text.align||""}return null},onEditLayerKeyDown:function(e,t,n){var i=e.ui.mapLayers.get(t);if(!t.lock&&!i.hasClass("ipages-editing")){var a=!1;switch(n.which){case 37:--t.x,a=!0;break;case 38:--t.y,a=!0;break;case 39:t.x+=1,a=!0;break;case 40:t.y+=1,a=!0}a&&(n.preventDefault(),n.stopPropagation(),e.rootScope.scan())}},onEditLabelText:function(t,n,e,i){var a,o;function r(e){n.text.data=o.html(),""==n.text.data.replace("<br>","").trim()&&(n.text.data=t.msg_edit_text,o.html(n.text.data))}n.lock||"text"!=n.type||(a=t.ui.mapLayers.get(n),o=m(e),a.addClass("ipages-editing"),o.attr("contenteditable",!0).focus(),o.on("input",r),o.one("blur",function(e){a.removeClass("ipages-editing"),o.attr("contenteditable",!1),o.off("input",r)}))},onEditLayerStart:function(e,t,n,i){var a=e.ui.mapLayers.get(t);t.lock||a.hasClass("ipages-editing")||(e.fn.onLayerClick(e,t),e.ui.editLayer.type=n,e.ui.editLayer.initX=i.pageX,e.ui.editLayer.initY=i.pageY,e.ui.editLayer.lastX=i.pageX,e.ui.editLayer.lastY=i.pageY,e.ui.editLayer.centerX=a.offset().left+a.width()/2,e.ui.editLayer.centerY=a.offset().top+a.height()/2,e.ui.editLayer.rotation=Math.atan2(i.pageY-e.ui.editLayer.centerY,i.pageX-e.ui.editLayer.centerX),e.ui.editLayer.layerAngle=t.angle,e.ui.editLayer.layerX=t.x,e.ui.editLayer.layerY=t.y,e.ui.editLayer.layerWidth=t.width,e.ui.editLayer.layerHeight=t.height,"drag"!=n&&(i.preventDefault(),i.stopPropagation()),m("body").on("mousemove",m.proxy(e.fn.onEditLayerMove,this,e,t)),m("body").on("mouseup",m.proxy(e.fn.onEditLayerEnd,this,e,t)),m("body").on("mouseleave",m.proxy(e.fn.onEditLayerEnd,this,e,t)))},onEditLayerMove:function(n,i,a){a.preventDefault(),a.stopPropagation();var e,t,o,r=n.ui.editPageZoom;function s(){var e=a.pageX-n.ui.editLayer.initX,t=n.ui.editLayer.layerX+e/r,e=n.ui.editLayer.layerWidth-e;e<=0?i.width=0:(i.width=e,i.x=t),n.rootScope.scan()}function l(){var e=a.pageY-n.ui.editLayer.initY,t=n.ui.editLayer.layerY+e/r,e=n.ui.editLayer.layerHeight-e;e<=0?i.height=0:(i.height=e,i.y=t),n.rootScope.scan()}function c(){var e=a.pageX-n.ui.editLayer.initX,e=n.ui.editLayer.layerWidth+e;i.width=e<=0?0:e,n.rootScope.scan()}function u(){var e=a.pageY-n.ui.editLayer.initY,e=n.ui.editLayer.layerHeight+e;i.height=e<=0?0:e,n.rootScope.scan()}switch(n.ui.editLayer.type){case"drag":t=a.pageX-n.ui.editLayer.lastX,o=a.pageY-n.ui.editLayer.lastY,n.ui.editLayer.lastX=a.pageX,n.ui.editLayer.lastY=a.pageY,i.x=i.x+t/r,i.y=i.y+o/r,n.rootScope.scan();break;case"rotate":e=(Math.atan2(a.pageY-n.ui.editLayer.centerY,a.pageX-n.ui.editLayer.centerX)-n.ui.editLayer.rotation)*(180/Math.PI),i.angle=n.ui.editLayer.layerAngle+e,i.angle<0?i.angle=360+i.angle:360<=i.angle&&(i.angle=i.angle-360),n.rootScope.scan();break;case"tl":l(),s();break;case"tm":l();break;case"tr":l(),c();break;case"rm":c();break;case"br":u(),c();break;case"bm":u();break;case"bl":u(),s();break;case"lm":s()}},onEditLayerEnd:function(e,t,n){n.preventDefault(),n.stopPropagation(),m("body").off("mousemove",m.proxy(e.fn.onEditLayerMove,this,e,t)),m("body").off("mouseup",m.proxy(e.fn.onEditLayerEnd,this,e,t)),m("body").off("mouseleave",m.proxy(e.fn.onEditLayerEnd,this,e,t)),e.ui.editLayer.type=null,e.ui.editLayer.initX=null,e.ui.editLayer.initY=null,e.ui.editLayer.lastX=null,e.ui.editLayer.lastY=null,e.ui.editLayer.centerX=null,e.ui.editLayer.centerY=null,e.ui.editLayer.rotation=0,e.ui.editLayer.layerAngle=null,e.ui.editLayer.layerX=null,e.ui.editLayer.layerY=null,e.ui.editLayer.layerWidth=null,e.ui.editLayer.layerHeight=null},uuid:function(e){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});return 0<e?t.substring(0,e):t},floor:function(e,t){return Math.floor(t)}},modal:{count:0,items:[],fn:{resize:function(e){var t=m("#ipages-modal-"+e.id),n=(t.find(".ipages-modal-dialog"),t.find(".ipages-modal-header")),e=t.find(".ipages-modal-data"),t=t.find(".ipages-modal-footer"),n=n.outerHeight()+t.outerHeight()+50,t=m(window).height();t-n<e.height()&&e.outerHeight(t-n)},show:function(i,e,n,t){var a=++i.modal.count,o=m.Deferred();return i.modal.items.push(a),i.inprocess++,m.ajax({url:i.wp_ajax_url,type:"GET",dataType:"html",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_modal,name:e}}).done(function(e){m("body").addClass("ipages-modal-open");var e=m(e),t={};t.modalData=n,t.modalData.id=a,t.modalData.deferred=o,t.modalData.appData=i,null!=n.easyClose&&!n.easyClose||e.on("click",function(e){t.modalData.deferred.resolve("close")}),m("#ipages-modals").append(e),e.find(".ipages-modal-dialog").on("click",function(e){return!1}),n.rootScope=i.alight(e.get(0),t),i.modal.fn.resize(n)}).fail(function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error")}).always(function(){t&&"function"==typeof t&&t.call(this,n),i.inprocess--}),o.promise()},close:function(e,t){m("#ipages-modal-"+t).remove();t=e.modal.items.indexOf(t);e.modal.items.splice(t,1),0==e.modal.items.length&&jQuery("body").removeClass("ipages-modal-open")}}}};window.alightInitCallback=function(e){delete window.alightInitCallback,e.directives.al.text={restrict:"EA",link:function(i,e,a,o){var r=m(e),s=r.attr("data-regex"),l=m(e);l.on("input change",function(e){var t=l.val(),n=!0;!function(e){return!e||/^\s*$/.test(e)}(t)?s&&(t.match(s)||(n=!1)):t=null;n?(o.setValue(a,t),o.scan(),function(){var e=r.data("callback");e&&o.changeDetector.compile(e)(i)}(),r.removeClass("ipages-invalid")):r.addClass("ipages-invalid")}),void 0===o.getValue(a)&&void 0!==r.attr("data-default")&&(e=r.data("default"),o.setValue(a,e)),o.watch(a,function(e){null==e?l.val(null):l.val(e)},{readOnly:!0})}},e.directives.al.textarea={restrict:"EA",link:function(n,e,i,a){var o=m(e),r=m(e);o.addClass("ipages-textarea"),r.on("input change",function(e){var t=r.val();!function(e){return!e||/^\s*$/.test(e)}(t)||(t=null);a.setValue(i,t),a.scan(),function(){var e=o.data("callback");e&&a.changeDetector.compile(e)(n)}()}),a.watch(i,function(e){null==e?r.val(null):r.val(e)},{readOnly:!0})}},e.directives.al.integer={restrict:"EA",link:function(i,e,a,o){var r=m(e),s=m(e);s.on("input change",function(e){var t=s.val(),n=!0;!function(e){return!e||/^\s*$/.test(e)}(t)?t.match("^([+-]?[1-9]+[0-9]*|0)$")?t=parseInt(t,10):n=!1:t=null;n?(o.setValue(a,t),o.scan(),function(){var e=r.data("callback");e&&o.changeDetector.compile(e)(i)}(),r.removeClass("ipages-invalid")):r.addClass("ipages-invalid")}),o.watch(a,function(e){r.removeClass("ipages-invalid"),null==e?s.val(null):s.val(e)},{readOnly:!0})}},e.directives.al.float={restrict:"EA",link:function(i,e,a,o){var r=m(e),s=m(e);s.on("input change",function(e){var t=s.val(),n=!0;!function(e){return!e||/^\s*$/.test(e)}(t)?t.match("^[+-]?([0-9]+([.][0-9]*)?|[.][0-9]+)$")?t=parseFloat(t):n=!1:t=null;n?(o.setValue(a,t),o.scan(),function(){var e=r.data("callback");e&&o.changeDetector.compile(e)(i)}(),r.removeClass("ipages-invalid")):r.addClass("ipages-invalid")}),o.watch(a,function(e){r.removeClass("ipages-invalid"),null==e?s.val(null):s.val(e)},{readOnly:!0})}},e.directives.al.toggle={restrict:"EA",link:function(t,e,n,i){var a=m(e);a.addClass("ipages-toggle").html("&nbsp;"),a.on("mousedown touchstart",function(e){i.setValue(n,!i.getValue(n)),i.scan(),function(){var e=a.data("callback");e&&i.changeDetector.compile(e)(t)}()}),i.watch(n,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},e.directives.al.checkbox={restrict:"EA",link:function(t,e,n,i){var a=m(e);a.addClass("ipages-checkbox"),a.on("mousedown touchstart",function(e){i.setValue(n,!i.getValue(n)),i.scan(),function(){var e=a.data("callback");e&&i.changeDetector.compile(e)(t)}()}),i.watch(n,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},e.directives.al.dragdrop={restrict:"EA",link:function(a,e,o,r){var t=m(e);t.attr("draggable",!0);var s=m("<div></div>").addClass("ipages-drag-before"),n=m("<div></div>").addClass("ipages-drag-after");t.append(s,n);var i=r.takeAttr("on-drag"),l=r.takeAttr("on-drop"),c=r.takeAttr("get-drag-element"),u=null,p=new Image;function d(){t.removeClass("ipages-drag-over"),s.removeClass("ipages-drag-over"),n.removeClass("ipages-drag-over"),m(window).off("dragover",f),u&&u.remove()}function f(e){var t=window.innerHeight||m(window).height();e.clientY<30?m(window).scrollTop(m(window).scrollTop()-10):e.clientY>t-30&&m(window).scrollTop(m(window).scrollTop()+10),u&&u.css({top:e.clientY-u.outerHeight()/2,left:e.clientX-u.outerWidth()-20})}function g(e){e.preventDefault(),m(this).addClass("ipages-drag-over")}function h(e){m(this).removeClass("ipages-drag-over")}p.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",t.on("dragstart",function(e){{var t,n;i&&(t=r.changeDetector.compile(i,{input:["item"]}),n=r.getValue(o),t(a,n))}e.originalEvent.dataTransfer.setData("Text","fix for firefox"),c&&(e.originalEvent.dataTransfer.setDragImage(p,0,0),u=r.getValue(c),m("body").append(u),m(window).on("dragover",f))}),s.on("dragover",g),n.on("dragover",g),s.on("dragleave",h),n.on("dragleave",h),t.on("drop",function(e){var t=s.hasClass("ipages-drag-over");{var n,i;d(),l&&(n=r.changeDetector.compile(l,{input:["item","before"]}),i=r.getValue(o),n(a,i,t))}}),t.on("dragend",function(e){d()})}},e.directives.al.pageImage={restrict:"EA",link:function(t,n,e,i){var a=i.takeAttr("on-page-image-update"),o=i.changeDetector.compile(a,{input:["page","$element"]}),r=i.getValue(e);i.watch(e,function(e){o(t,r,n)},{readOnly:!0,deep:3})}},e.directives.al.style={restrict:"EA",link:function(e,t,n,i){var a,o;i.attrArgument&&(a=m(t),o=i.attrArgument.split(".")[0],i.watch(n,function(e){a.css(o,e)},{readOnly:!0}))}},e.directives.al.backgroundrepeat={restrict:"EA",link:function(e,t,n,i){var t=m(t),a=m("<select/>").addClass(t.get(0).className);a.append('<option value="none">none</option>'),a.append('<option value="repeat">repeat</option>'),a.append('<option value="repeat-x">repeat-x</option>'),a.append('<option value="repeat-y">repeat-y</option>'),a.append('<option value="no-repeat">no-repeat</option>'),t.append(a),a.unwrap(),a.on("change",function(e){var t=a.val();"none"==t&&(t=null);i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?a.val("none"):a.val(e)},{readOnly:!0})}},e.directives.al.backgroundsize={restrict:"EA",link:function(e,t,n,i){var t=m(t),a=m("<select/>").addClass(t.get(0).className);a.append('<option value="none">none</option>'),a.append('<option value="auto">auto</option>'),a.append('<option value="cover">cover</option>'),a.append('<option value="contain">contain</option>'),a.append('<option value="100% 100%">stretch</option>'),t.append(a),a.unwrap(),a.on("change",function(e){var t=a.val();"none"==t&&(t=null);i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?a.val("none"):a.val(e)},{readOnly:!0})}},e.directives.al.textalign={restrict:"EA",link:function(e,t,n,i){var t=m(t),a=m("<select/>").addClass(t.get(0).className);a.append('<option value="none">none</option>'),a.append('<option value="left">left</option>'),a.append('<option value="right">right</option>'),a.append('<option value="center">center</option>'),a.append('<option value="justify">justify</option>'),t.append(a),a.unwrap(),a.on("change",function(e){var t=a.val();"none"==t&&(t=null);i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?a.val("none"):a.val(e)},{readOnly:!0})}},e.directives.al.pagetype={restrict:"EA",link:function(e,t,n,i){var t=m(t),a=m("<select/>").addClass(t.get(0).className);a.append('<option value="image">image</option>'),a.append('<option value="pdf">pdf</option>'),t.append(a),a.unwrap(),a.on("change",function(e){var t=a.val();"none"==t&&(t=null);i.setValue(n,t),i.scan()}),i.watch(n,function(e){null==e?a.val("none"):a.val(e)},{readOnly:!0})}},e.directives.al.color={restrict:"EA",link:function(t,i,a,o){var n=m(i),r=m("<div></div>").addClass("ipages-color-btn").append("<div><div></div></div>"),s=m("<input/>").addClass("ipages-color-value");n.append(r,s),r.on("click touchend",function(e){u.show(r,o.getValue(a))}),s.on("input change",function(e){var t=m(this).val(),n=!0;!function(e){return!e||/^\s*$/.test(e)}(t)?(new c).setColor(t)||(n=!1):t=null;n?(o.setValue(a,t),o.scan(),p(),m(i).removeClass("ipages-invalid")):m(i).addClass("ipages-invalid")});var l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}}];function c(){this.rgb={r:0,g:0,b:0},this.hsb={h:0,s:0,b:0},this.alpha=1}function e(e){this.config=null,this.color=new c,this.controls={},this.inputEdit={enabled:!1,pageY:0,value:0,type:null},this._init(e)}c.prototype={rgb:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},rgba:function(){return"rgba("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+","+this.alpha+")"},hex:function(){return this.toHex()},RGBAtoHSBA:function(e,t,n,i){var a,o,r=0,s=Math.max(e,t,n),l=s-Math.min(e,t,n),c=s/255,u=0!=s?l/s:0;return u&&(a=(s-e)/l,o=(s-t)/l,l=(s-n)/l,r=e==s?l-o:t==s?2+a-l:4+o-a,(r/=6)<0&&r++),{h:Math.round(360*r),s:Math.round(100*u),b:Math.round(100*c),a:i||1}},HSBAtoRGBA:function(e,t,n,i){var a,o,r;return e=(e=e)%360/60,n=a=o=(n=n/100)-(r=n*(t=t/100)),n+=[r,t=r*(1-Math.abs(e%2-1)),0,0,t,r][e=~~e],a+=[t,r,r,t,0,0][e],o+=[0,0,t,r,r,t][e],{r:Math.round(255*n),g:Math.round(255*a),b:Math.round(255*o),a:i||1}},setColor:function(e){for(var t in e=e.toLowerCase(),l)if(l.hasOwnProperty(t)){var n=l[t],t=n.re.exec(e),n=t&&n.parse(t);if(n){t=this.RGBAtoHSBA.apply(null,n);return this.hsb={h:t.h,s:t.s,b:t.b},this.rgb={r:n[0],g:n[1],b:n[2]},this.alpha=t.a,!0}}return!1},setRed:function(e){255<e?e=255:e<0&&(e=0),this.rgb.r=e;e=this.RGBAtoHSBA(this.rgb.r,this.rgb.g,this.rgb.b);this.hsb={h:e.h,s:e.s,b:e.b}},setGreen:function(e){255<e?e=255:e<0&&(e=0),this.rgb.g=e;e=this.RGBAtoHSBA(this.rgb.r,this.rgb.g,this.rgb.b);this.hsb={h:e.h,s:e.s,b:e.b}},setBlue:function(e){255<e?e=255:e<0&&(e=0),this.rgb.b=e;e=this.RGBAtoHSBA(this.rgb.r,this.rgb.g,this.rgb.b);this.hsb={h:e.h,s:e.s,b:e.b}},setHue:function(e){360<e?e=360:e<0&&(e=0),this.hsb.h=e;e=this.HSBAtoRGBA(this.hsb.h,this.hsb.s,this.hsb.b);this.rgb={r:e.r,g:e.g,b:e.b}},setSaturation:function(e){100<e?e=100:e<0&&(e=0),this.hsb.s=e;e=this.HSBAtoRGBA(this.hsb.h,this.hsb.s,this.hsb.b);this.rgb={r:e.r,g:e.g,b:e.b}},setBrightness:function(e){100<e?e=100:e<0&&(e=0),this.hsb.b=e;e=this.HSBAtoRGBA(this.hsb.h,this.hsb.s,this.hsb.b);this.rgb={r:e.r,g:e.g,b:e.b}},setAlpha:function(e){1<(e=parseInt(100*e,10)/100)?e=1:e<0&&(e=0),this.alpha=e},toRGBA:function(){return{r:this.rgb.r,g:this.rgb.g,b:this.rgb.b,a:this.alpha}},toHSBA:function(){return{h:this.hsb.h,s:this.hsb.s,b:this.hsb.b,a:this.alpha}},toHex:function(){return"#"+(1<<24|parseInt(this.rgb.r,10)<<16|parseInt(this.rgb.g,10)<<8|parseInt(this.rgb.b,10)).toString(16).substr(1)}},e.prototype={defaults:{onSelect:null},_init:function(e){this.config=m.extend(!0,{},this.defaults,e),this._create()},_create:function(){this._buildDOM(),this._bind(),this._refresh()},_buildDOM:function(){var e=m("<div></div>").addClass("ipages-data"),t=m("<div></div>").addClass("ipages-color-picker"),n=m("<div></div>").addClass("ipages-thumb"),i=m("<div></div>").addClass("ipages-pallete").append(n),a=m("<div></div>").addClass("ipages-thumb"),o=m("<div></div>").addClass("ipages-hue").append(a),r=m("<div></div>").addClass("ipages-panel"),s=m("<div></div>").addClass("ipages-input").append('<span>R<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>'),l=m("<div></div>").addClass("ipages-input").append('<span>G<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>'),c=m("<div></div>").addClass("ipages-input").append('<span>B<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>'),u=m("<div></div>").addClass("ipages-line"),p=m("<div></div>").addClass("ipages-input").append('<span>H<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>'),d=m("<div></div>").addClass("ipages-input").append('<span>S<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>'),f=m("<div></div>").addClass("ipages-input").append('<span>B<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>');r.append(s,l,c,u,p,d,f),t.append(e.append(i,o,r)),this.controls.$picker=t,this.controls.$pallete=i,this.controls.$pallete_thumb=n,this.controls.$hue=o,this.controls.$hue_thumb=a,this.controls.$input_rgb_r=s.find("input"),this.controls.$input_rgb_g=l.find("input"),this.controls.$input_rgb_b=c.find("input"),this.controls.$input_hsb_h=p.find("input"),this.controls.$input_hsb_s=d.find("input"),this.controls.$input_hsb_b=f.find("input"),this.controls.$input_rgb_r_thumb=s.find(".ipages-thumb"),this.controls.$input_rgb_g_thumb=l.find(".ipages-thumb"),this.controls.$input_rgb_b_thumb=c.find(".ipages-thumb"),this.controls.$input_hsb_h_thumb=p.find(".ipages-thumb"),this.controls.$input_hsb_s_thumb=d.find(".ipages-thumb"),this.controls.$input_hsb_b_thumb=f.find(".ipages-thumb");e=m("<div></div>").addClass("ipages-data"),c=m("<div></div>").addClass("ipages-thumb"),p=m("<div></div>").addClass("ipages-gradient"),d=m("<div></div>").addClass("ipages-alpha").append(p,c),r=m("<div></div>").addClass("ipages-panel"),f=m("<div></div>").addClass("ipages-input").append('<span>A<input type="text" maxlength="3" size="3"/><span class="ipages-thumb"></span></span>');r.append(f),t.append(e.append(d,r)),this.controls.$alpha=d,this.controls.$alpha_thumb=c,this.controls.$alpha_gradient=p,this.controls.$input_alpha=f.find("input"),this.controls.$input_alpha_thumb=f.find(".ipages-thumb");e=m("<div></div>").addClass("ipages-data"),c=m("<div></div>").addClass("ipages-preview").append("<div><div></div></div>"),p=m("<input readonly />").addClass("ipages-input-color"),f=m("<div></div>").addClass("ipages-submit").text("OK");t.append(e.append(c,p,f)),this.controls.$preview=c.find("> div > div"),this.controls.$input_color=p,this.controls.$submit=f,t.appendTo("body")},_bind:function(){this.controls.$pallete.on("mousedown",m.proxy(this._onPalleteEditStart,this)),this.controls.$pallete.on("click",m.proxy(this._onPalleteEditMove,this)),this.controls.$hue.on("mousedown",m.proxy(this._onHueEditStart,this)),this.controls.$hue.on("click",m.proxy(this._onHueEditMove,this)),this.controls.$alpha.on("mousedown",m.proxy(this._onAlphaEditStart,this)),this.controls.$alpha.on("click",m.proxy(this._onAlphaEditMove,this)),this.controls.$input_rgb_r_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"rgb_r")),this.controls.$input_rgb_g_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"rgb_g")),this.controls.$input_rgb_b_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"rgb_b")),this.controls.$input_hsb_h_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"hsb_h")),this.controls.$input_hsb_s_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"hsb_s")),this.controls.$input_hsb_b_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"hsb_b")),this.controls.$input_alpha_thumb.on("mousedown",m.proxy(this._onInputEditStart,this,"alpha")),this.controls.$input_rgb_r.on("input",m.proxy(this._onInput,this,"rgb_r")),this.controls.$input_rgb_g.on("input",m.proxy(this._onInput,this,"rgb_g")),this.controls.$input_rgb_b.on("input",m.proxy(this._onInput,this,"rgb_b")),this.controls.$input_hsb_h.on("input",m.proxy(this._onInput,this,"hsb_h")),this.controls.$input_hsb_s.on("input",m.proxy(this._onInput,this,"hsb_s")),this.controls.$input_hsb_b.on("input",m.proxy(this._onInput,this,"hsb_b")),this.controls.$input_alpha.on("input",m.proxy(this._onInput,this,"alpha")),this.controls.$submit.on("click",m.proxy(this._onSubmit,this))},_refresh:function(){var e=this.color.toRGBA(),t=this.color.toHSBA(),n=this.controls.$pallete.outerHeight()-2,i=this.controls.$pallete.outerWidth()-2;this.controls.$pallete.css({"background-color":"hsl("+t.h+", 100%, 50%)"}),this.controls.$pallete_thumb.css({top:parseInt(n-n*t.b/100,10)}),this.controls.$pallete_thumb.css({left:parseInt(i-i*(100-t.s)/100,10)});n=this.controls.$hue.outerHeight()-2;this.controls.$hue_thumb.css({top:parseInt(n-n*t.h/360,10)});i=this.controls.$alpha.outerWidth()-2;this.controls.$alpha_thumb.css({left:parseInt(i-i*(1-t.a),10)}),this.controls.$alpha_gradient.css({background:"linear-gradient(to left,"+this.color.hex()+",rgba(0,0,0,0))"}),this.controls.$input_rgb_r.val(e.r),this.controls.$input_rgb_g.val(e.g),this.controls.$input_rgb_b.val(e.b),this.controls.$input_hsb_h.val(t.h),this.controls.$input_hsb_s.val(t.s),this.controls.$input_hsb_b.val(t.b),this.controls.$input_alpha.val(parseInt(100*e.a,10)),this.controls.$preview.css({"background-color":this.color.rgba()}),this.controls.$input_color.val(1!=e.a?this.color.rgba():this.color.hex())},_show:function(e){var t=e.offset(),n=e.outerWidth(),i=e.outerHeight(),a=this.controls.$picker.outerWidth(),o=this.controls.$picker.outerHeight(),r=t.top-o-1,e=t.left;this.controls.$picker.offset({top:r,left:e});o=this.controls.$picker.get(0).getBoundingClientRect();o.y<0&&(r=t.top+i+t.height+1,this.controls.$picker.offset({top:r})),o.x+o.width>window.innerWidth&&(e=t.left+n-a,this.controls.$picker.offset({left:e})),this.controls.$picker.addClass("ipages-active"),m("body").on("mousedown touchstart",m.proxy(this._onBodyClick,this))},_hide:function(){this.controls.$picker.removeClass("ipages-active").css({top:"",left:""}),m("body").off("mousedown touchstart",m.proxy(this._onBodyClick,this))},_destroy:function(){this.controls.$picker&&this.controls.$picker.remove(),this.config=null,this.color=new c,this.controls={}},_onPalleteEditStart:function(e){m("body").on("mouseup",m.proxy(this._onPalleteEditEnd,this)),m("body").on("mousemove",m.proxy(this._onPalleteEditMove,this))},_onPalleteEditMove:function(e){var t=this.controls.$pallete.outerHeight(),n=this.controls.$pallete.outerWidth(),n=100-parseInt(100*(n-Math.max(0,Math.min(n,e.pageX-this.controls.$pallete.offset().left)))/n,10),t=parseInt(100*(t-Math.max(0,Math.min(t,e.pageY-this.controls.$pallete.offset().top)))/t,10);return this.color.setSaturation(n),this.color.setBrightness(t),this._refresh(),!1},_onPalleteEditEnd:function(e){return m("body").off("mouseup",m.proxy(this._onPalleteEditEnd,this)),m("body").off("mousemove",m.proxy(this._onPalleteEditMove,this)),this._refresh(),!1},_onHueEditStart:function(e){m("body").on("mouseup",m.proxy(this._onHueEditEnd,this)),m("body").on("mousemove",m.proxy(this._onHueEditMove,this))},_onHueEditMove:function(e){var t=this.controls.$hue.outerHeight(),t=parseInt(360*(t-Math.max(0,Math.min(t,e.pageY-this.controls.$hue.offset().top)))/t,10);return this.color.setHue(t),this._refresh(),!1},_onHueEditEnd:function(e){return m("body").off("mouseup",m.proxy(this._onHueEditEnd,this)),m("body").off("mousemove",m.proxy(this._onHueEditMove,this)),this._refresh(),!1},_onAlphaEditStart:function(e){m("body").on("mouseup",m.proxy(this._onAlphaEditEnd,this)),m("body").on("mousemove",m.proxy(this._onAlphaEditMove,this))},_onAlphaEditMove:function(e){var t=this.controls.$alpha.outerWidth(),t=1-(t-Math.max(0,Math.min(t,e.pageX-this.controls.$alpha.offset().left)))/t;return this.color.setAlpha(t),this._refresh(),!1},_onAlphaEditEnd:function(e){return m("body").off("mouseup",m.proxy(this._onAlphaEditEnd,this)),m("body").off("mousemove",m.proxy(this._onAlphaEditMove,this)),this._refresh(),!1},_onInputEditStart:function(e,t){m("body").on("mouseup",m.proxy(this._onInputEditEnd,this)),m("body").on("mousemove",m.proxy(this._onInputEditMove,this)),this.inputEdit.enabled=!0,this.inputEdit.pageY=t.pageY,this.inputEdit.value=parseInt(m(t.target).siblings("input").val(),10),this.inputEdit.type=e},_onInputEditMove:function(e){if(this.inputEdit.enabled){var e=e.pageY-this.inputEdit.pageY,t=this.inputEdit.value+e;switch(this.inputEdit.type){case"rgb_r":this.color.setRed(t);break;case"rgb_g":this.color.setGreen(t);break;case"rgb_b":this.color.setBlue(t);break;case"hsb_h":this.color.setHue(t);break;case"hsb_s":this.color.setSaturation(t);break;case"hsb_b":this.color.setBrightness(t);break;case"alpha":this.color.setAlpha(t/100)}}return this._refresh(),!1},_onInputEditEnd:function(e){return m("body").off("mouseup",m.proxy(this._onInputEditEnd,this)),m("body").off("mousemove",m.proxy(this._onInputEditMove,this)),this.inputEdit.enabled=!1,this.inputEdit.pageY=0,this.inputEdit.value=0,this.inputEdit.type=null,this._refresh(),!1},_onInput:function(e,t){var n=m(t.target).val(),n=parseInt(n,10)||0;switch(e){case"rgb_r":this.color.setRed(n);break;case"rgb_g":this.color.setGreen(n);break;case"rgb_b":this.color.setBlue(n);break;case"hsb_h":this.color.setHue(n);break;case"hsb_s":this.color.setSaturation(n);break;case"hsb_b":this.color.setBrightness(n);break;case"alpha":this.color.setAlpha(n/100)}return this._refresh(),!1},_onSubmit:function(e){this._hide(),"function"==typeof this.config.onSelect&&this.config.onSelect.call(this,this.color)},_onBodyClick:function(e){0!==this.controls.$picker.has(e.target).length||m(e.target).hasClass("ipages-color-picker")||this._hide()},show:function(e,t){t&&(this.color.setColor(t),this._refresh()),this._show(e)},hide:function(){this._hide()},destroy:function(){this._destroy()}};var u=new e({onSelect:function(e){e=1==e.alpha?e.hex():e.rgba();o.setValue(a,e),o.scan(),p(),s.val(e)}});function p(){var e=n.data("callback");e&&o.changeDetector.compile(e)(t)}o.changeDetector.watch("$destroy",function(){u.destroy()}),o.watch(a,function(e){var t;m(i).removeClass("ipages-invalid"),null==e?(s.val(null),r.find("> div > div").css({"background-color":""})):((t=new c).setColor(e)?r.find("> div > div").css({"background-color":t.rgba()}):r.find("> div > div").css({"background-color":""}),s.val(e))},{readOnly:!0})}},n.config=m.extend(!0,{},n.defaultConfig),n.alight=e,n.rootScope=n.alight(document.querySelectorAll("#ipages-app-item")[0],{appData:n}),n.fn.init(n)}}function r(){var t={alight:null,rootScope:null,wp_ajax_url:null,wp_ajax_nonce:null,wp_ajax_action_update:null,wp_ajax_action_get:null,wp_ajax_action_delete_data:null,wp_ajax_action_modal:null,wp_ajax_msg_error:null,themes:null,roles:null,config:{themeJavaScript:null,themeCSS:null,pdfProgressiveLoading:!0,roles:null},defaultConfig:{themeJavaScript:null,themeCSS:null,pdfProgressiveLoading:!0,roles:null},fn:{init:function(e){m("#ipages-app-settings").removeAttr("style"),e.plan=ipages_flipbook_globals.plan,e.wp_ajax_url=ipages_flipbook_globals.ajax_url,e.wp_ajax_nonce=ipages_flipbook_globals.ajax_nonce,e.wp_ajax_action_update=ipages_flipbook_globals.ajax_action_update,e.wp_ajax_action_get=ipages_flipbook_globals.ajax_action_get,e.wp_ajax_action_delete_data=ipages_flipbook_globals.ajax_action_delete_data,e.wp_ajax_action_modal=ipages_flipbook_globals.ajax_action_modal,e.wp_ajax_msg_error=ipages_flipbook_globals.ajax_msg_error,e.fn.initConfig(e)},enableLoading:function(e){m("#ipages-app-settings").removeClass("ipages-active")},disableLoading:function(e){setTimeout(function(){m("#ipages-app-settings").addClass("ipages-active")},1e3)},loadData:function(i,e){var a=m.Deferred();return m.ajax({url:i.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_get,type:e},success:function(e){e&&e.success?a.resolve(e.data):this.error()},error:function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error"),a.reject()}}),a.promise()},initConfig:function(t){t.fn.enableLoading(t);var e=m.extend(!0,{},t.defaultConfig,ipages_flipbook_globals.config?JSON.parse(ipages_flipbook_globals.config):null);t.config=e,t.fn.loadData(t,"editor-themes").done(function(e){t.themes=e.list}).always(function(){t.rootScope.scan(),t.fn.disableLoading(t)}),t.fn.loadData(t,"roles").done(function(e){t.roles=e.list}).always(function(){t.rootScope.scan(),t.fn.disableLoading(t)})},saveConfig:function(t){t.fn.enableLoading(t);var e=m.extend(!0,{},t.config),e=JSON.stringify(e);m.ajax({url:t.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:t.wp_ajax_nonce,action:t.wp_ajax_action_update,config:e}}).done(function(e){e?t.fn.showNotice(t,e.data.msg,e.success?"notice-success":"notice-error"):t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).fail(function(){t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).always(function(){t.fn.disableLoading(t)})},deleteAllData:function(t,e){var n={text:e};t.modal.fn.show(t,"confirm",n).then(function(e){t.modal.fn.close(t,n.id),"close"!=e&&e&&(t.fn.enableLoading(t),m.ajax({url:t.wp_ajax_url,type:"POST",dataType:"json",data:{nonce:t.wp_ajax_nonce,action:t.wp_ajax_action_delete_data}}).done(function(e){e?t.fn.showNotice(t,e.data.msg,e.success?"notice-success":"notice-error"):t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).fail(function(){t.fn.showNotice(t,t.wp_ajax_msg_error,"notice-error")}).always(function(){t.fn.disableLoading(t),t.rootScope.scan()}),t.rootScope.scan())})},showNotice:function(e,t,n){var i=m("#ipages-messages"),a=m("<div></div>").addClass("notice is-dismissible").addClass(n),n=m("<p></p>").html(t),t=m("<button></button>").attr("type","button").addClass("notice-dismiss").html('<span class="screen-reader-text">Dismiss this notice.</span>');function o(){clearTimeout(a.data("timer")),a.fadeTo(100,0,function(){a.slideUp(100,function(){a.remove()})})}a.data("timer",setTimeout(o,5e3)),t.click(function(e){e.preventDefault(),o()}),a.append(n,t),i.append(a)}},modal:{count:0,items:[],fn:{resize:function(e){var t=m("#ipages-modal-"+e.id),n=(t.find(".ipages-modal-dialog"),t.find(".ipages-modal-header")),e=t.find(".ipages-modal-data"),t=t.find(".ipages-modal-footer"),n=n.outerHeight()+t.outerHeight()+50,t=m(window).height();t-n<e.height()&&e.outerHeight(t-n)},show:function(i,e,n,t){var a=++i.modal.count,o=m.Deferred();return i.modal.items.push(a),i.inprocess++,m.ajax({url:i.wp_ajax_url,type:"GET",dataType:"html",data:{nonce:i.wp_ajax_nonce,action:i.wp_ajax_action_modal,name:e}}).done(function(e){m("body").addClass("ipages-modal-open");var e=m(e),t={};t.modalData=n,t.modalData.id=a,t.modalData.deferred=o,t.modalData.appData=i,null!=n.easyClose&&!n.easyClose||e.on("click",function(e){t.modalData.deferred.resolve("close")}),m("#ipages-modals").append(e),e.find(".ipages-modal-dialog").on("click",function(e){return!1}),n.rootScope=i.alight(e.get(0),t),i.modal.fn.resize(n)}).fail(function(e,t,n){i.fn.showNotice(i,i.wp_ajax_msg_error,"notice-error")}).always(function(){t&&"function"==typeof t&&t.call(this,n),i.inprocess--}),o.promise()},close:function(e,t){m("#ipages-modal-"+t).remove();t=e.modal.items.indexOf(t);e.modal.items.splice(t,1),0==e.modal.items.length&&jQuery("body").removeClass("ipages-modal-open")}}}};window.alightInitCallback=function(e){delete window.alightInitCallback,e.directives.al.toggle={restrict:"EA",link:function(t,e,n,i){var a=m(e);a.addClass("ipages-toggle").html("&nbsp;"),a.on("mousedown touchstart",function(e){i.setValue(n,!i.getValue(n)),i.scan(),function(){var e=a.data("callback");e&&i.changeDetector.compile(e)(t)}()}),i.watch(n,function(e){e?a.addClass("ipages-checked").removeClass("ipages-unchecked"):a.removeClass("ipages-checked").addClass("ipages-unchecked")},{readOnly:!0})}},e.directives.al.checkboxlist={restrict:"EA",link:function(l,e,c,u){var p=m(e),d=m("<ul>"),f=p.data("predefined"),g=p.data("src");p.addClass("ipages-checkboxlist").append(d),p.on("click",".ipages-checkbox",function(e){for(var t=m(this),n=t.parent().data("id"),i=u.getValue(g),a=0;a<i.length;a++)if(i[a].id==n){var o=u.getValue(c);if(o){for(var r=!0,s=0;s<o.length;s++)if(o[s]==n){r=!1,o.splice(s,1),t.removeClass("ipages-checked"),0==o.length&&(o=null);break}r&&(o.push(n),t.addClass("ipages-checked"))}else(o=[]).push(n),t.addClass("ipages-checked");u.setValue(c,o),u.scan(),function(){var e=p.data("callback");e&&u.changeDetector.compile(e)(l)}();break}}),g&&u.watch(g,function(e){var t=u.getValue(g),n=u.getValue(c);if(d.empty(),t instanceof Array)for(var i=0;i<t.length;i++){var a=m("<li>").attr({"data-id":t[i].id}),o=m("<div>").addClass("ipages-checkbox"),r=m("<div>").addClass("ipages-name").text(t[i].name);if(f==t[i].id&&o.addClass("ipages-checked ipages-readonly"),n instanceof Array)for(var s=0;s<n.length;s++)if(n[s]==t[i].id){o.addClass("ipages-checked");break}a.append(o,r),d.append(a)}},{readOnly:!0})}},t.alight=e,t.rootScope=t.alight(document.querySelectorAll("#ipages-app-settings")[0],{appData:t}),t.fn.init(t)}}"undefined"!=typeof module&&module.exports?module.exports.saveAs=a:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define([],function(){return a}),e=function(){function s(){for(var e=0,t={};e<arguments.length;e++){var n,i=arguments[e];for(n in i)t[n]=i[n]}return t}function c(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function e(l){function r(){}function n(e,t,n){if("undefined"!=typeof document){"number"==typeof(n=s({path:"/"},r.defaults,n)).expires&&(n.expires=new Date(+new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var i=JSON.stringify(t);/^[\{\[]/.test(i)&&(t=i)}catch(e){}t=l.write?l.write(t,e):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a,o="";for(a in n)n[a]&&(o+="; "+a,!0!==n[a]&&(o+="="+n[a].split(";")[0]));return document.cookie=e+"="+t+o}}function t(e,t){if("undefined"!=typeof document){for(var n={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var o=i[a].split("="),r=o.slice(1).join("=");t||'"'!==r.charAt(0)||(r=r.slice(1,-1));try{var s=c(o[0]),r=(l.read||l)(r,s)||c(r);if(t)try{r=JSON.parse(r)}catch(e){}if(n[s]=r,e===s)break}catch(e){}}return e?n[e]:n}}return r.set=n,r.get=function(e){return t(e,!1)},r.getJSON=function(e){return t(e,!0)},r.remove=function(e,t){n(e,"",s(t,{expires:-1}))},r.defaults={},r.withConverter=e,r}(function(){})},"function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),t||(n=window.Cookies,(i=window.Cookies=e()).noConflict=function(){return window.Cookies=n,i}),m("#ipages-app-items").length?m(".ipages-app .ipages-toggle").on("click touchend",function(e){e.stopPropagation(),e.preventDefault();var t,n,i,a=m(this),o=a.data("id"),r=null;a.hasClass("ipages-locked")||(a.addClass("ipages-readonly"),r=a.hasClass("ipages-checked")?(a.removeClass("ipages-checked").addClass("ipages-unchecked"),!1):(a.removeClass("ipages-unchecked").addClass("ipages-checked"),!0),t=ipages_flipbook_globals.ajax_url,n=ipages_flipbook_globals.ajax_nonce,e=ipages_flipbook_globals.ajax_action_update,i=ipages_flipbook_globals.ajax_msg_error,o={id:o,active:r},o=m.extend(!0,{},o),o=JSON.stringify(o),m.ajax({url:t,type:"POST",dataType:"json",data:{nonce:n,action:e,config:o}}).done(function(e){e&&!e.success&&(r?a.removeClass("ipages-checked").addClass("ipages-unchecked"):a.removeClass("ipages-unchecked").addClass("ipages-checked"))}).fail(function(){console.log(i)}).always(function(){a.removeClass("ipages-readonly")}))}):m("#ipages-app-item").length?o():m("#ipages-app-settings").length&&r();var s=m(".ipages-page-info");s.length&&!Cookies.get("ipages-page-info-hidden")&&s.addClass("ipages-active").find(".ipages-page-info-close").on("click",function(e){s.removeClass("ipages-active"),Cookies.set("ipages-page-info-hidden",!0,{expires:180})});var l,c=m(".ipages-page-feedback");function u(){var Y=function(e,t){return Y.bootstrap(e,t)};Y.version="0.14.0",Y.filters={},Y.text={},Y.core={},Y.utils={},Y.option={globalController:!1,removeAttribute:!0,domOptimization:!0,domOptimizationRemoveEmpty:!0,fastBinding:!0},Y.debug={scan:0,directive:!1,watch:!1,watchText:!1,parser:!1},Y.ctrl=Y.controllers={},Y.d=Y.directives={al:{},bo:{},$global:{}},Y.hooks={directive:[],binding:[]},Y.priority={al:{app:2e3,checked:20,class:30,css:30,focused:20,if:700,ifnot:700,model:25,radio:25,repeat:1e3,select:20,stop:-10,value:20,on:10},$component:5,$attribute:-5};function x(e,t){0<=(t=e.indexOf(t))?e.splice(t,1):console.warn("trying to remove not exist item")}var e,t,n,i,u,y,a,o,w,P,l,p,k,c,r,_,C,A,B,d,f,L,g,T,j,s,h,m,v,b,S,D,E,$,F,N,O,I,M,H,V,z,R,W,U,J,K,X,q,G,Z,Q,ee,te,ne,ie,ae,oe,re,se,le,ce=Y.f$={};function ue(t,e){var n,i,a,o,r=[],s=!1,l=e.cd,c=e.callback;return e.filterConf.args.length?(i=[],e.filterConf.args.forEach(function(e,t){e=l.watch(e,function(e){r[t+1]=e,o()});e.$.isStatic||i.push(e)}),a=!1,o=function(){a||(a=!0,l.watch("$onScanOnce",function(){var e;a=!1,s&&(e=t.apply(null,r),ce.isPromise(e)?e.then(function(e){c(e),l.scan()}):c(e))}))},i.length&&(n=function(){i.forEach(function(e){return e.stop()})})):o=function(){var e=t(r[0]);ce.isPromise(e)?e.then(function(e){c(e),l.scan()}):c(e)},{onChange:function(e){s=!0,r[0]=e,o()},onStop:n,watchMode:e.watchMode}}function pe(e,t,n,i,a,o){i.callback.apply(null,o);t=t._properties.root;t&&t.topCD&&t.topCD.scan({zone:!0})}function de(e,t,n,i){i.setValue(i.attrArgument,t)}function fe(e){return e.replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()})}function ge(e){var t,n=e.listener,i=e.childCD,a=e.name,o=e.parentName,r=e.parentCD,e={},a=fe(a);if(n&&!0!==n)if(le.isFunction(n))t=n;else{if(t=n.onChange,"copy"===n||"copy"===n.watchMode)return void(t?t(o):i.scope[a]=o);"array"!==n&&"array"!==n.watchMode||(e.isArray=!0),"deep"!==n&&"deep"!==n.watchMode||(e.deep=!0)}r.watch(o,t=t||function(e){i.scope[a]=e,i.scan()},e)}return ce.before=function(e,t){e.parentNode.insertBefore(t,e)},ce.after=function(e,t){var n=e.parentNode,e=e.nextSibling;e?n.insertBefore(t,e):n.appendChild(t)},ce.remove=function(e){var t=e.parentNode;t&&t.removeChild(e)},ce.on=function(e,t,n){e.addEventListener(t,n,!1)},ce.off=function(e,t,n){e.removeEventListener(t,n,!1)},ce.isFunction=function(e){return e&&"[object Function]"===Object.prototype.toString.call(e)},ce.isObject=function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},ce.isPromise=function(e){return e&&window.Promise&&e instanceof window.Promise},ce.isElement=function(e){return e instanceof HTMLElement},ce.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},ce.removeClass=function(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^| )"+t.split(" ").join("|")+"( |$)","gi")," ")},ce.rawAjax=function(e){var t,n=new XMLHttpRequest;for(t in n.open(e.type||"GET",e.url,!0,e.username,e.password),e.headers)n.setRequestHeader(t,e.headers[t]);e.success&&(n.onload=function(){200<=n.status&&n.status<400?e.success(n.responseText):e.error&&e.error()}),e.error&&(n.onerror=e.error),n.send(e.data||null)},ce.ajaxCache={},ce.ajax=function(e){if(e.username||e.password||e.headers||e.data||!e.cache)return ce.rawAjax(e);var t=e.type||"GET",n=t+":"+e.url,i=ce.ajaxCache[n];i||(ce.ajaxCache[n]=i={callback:[]}),i.result?e.success&&e.success(i.result):(i.callback.push(e),i.loading||(i.loading=!0,ce.rawAjax({type:t,url:e.url,success:function(e){i.loading=!1,i.result=e;for(var t=0;t<i.callback.length;t++)i.callback[t].success&&i.callback[t].success(e);i.callback.length=0},error:function(){i.loading=!1;for(var e=0;e<i.callback.length;e++)i.callback[e].error&&i.callback[e].error();i.callback.length=0}})))},e='@charset "UTF-8";[al-cloak],[hidden],.al-hide{display:none !important;}',t=document.querySelectorAll("head")[0],(ae=document.createElement("style")).setAttribute("type","text/css"),ae.styleSheet?ae.styleSheet.cssText=e:ae.appendChild(document.createTextNode(e)),t.appendChild(ae),ce.ready=(i=!(n=[]),ce.on(document,"DOMContentLoaded",function e(){i=!0,ce.off(document,"DOMContentLoaded",e);for(var t=0;t<n.length;t++)n[t]();n.length=0}),function(e){i?e():n.push(e)}),window.jQuery&&(window.jQuery.fn.alight=function(e){var n=[];if(this.each(function(e,t){return n.push(t)}),n.length)return Y(n,e)}),Y.core.getFilter=function(e,t){t=t.locals[e];if(t&&(ce.isFunction(t)||t.init||t.fn))return t;if(t=Y.filters[e])return t;throw"Filter not found: "+e},Y.core.buildFilterNode=function(e,t,n,i){if(ce.isFunction(n))return ue(n,{cd:e,filterConf:t,callback:i});if(n.init)return n.init.call(e,e.scope,t.raw,{setValue:i,conf:t,changeDetector:e});if(ce.isFunction(n.fn))return ue(n.fn,{cd:e,filterConf:t,callback:i,watchMode:n.watchMode});throw"Wrong filter: "+t.name},Y.ChangeDetector=function(e){var t=new a,e=new u(t,e||{});return t.topCD=e},(a=function(){return this.watchers={any:[],finishBinding:[],finishScan:[],finishScanOnce:[],onScanOnce:[]},this.status=null,this.extraLoop=!1,this.finishBinding_lock=!1,this.lateScan=!1,this.topCD=null,this}).prototype.destroy=function(){if(this.watchers.any.length=0,this.watchers.finishBinding.length=0,this.watchers.finishScan.length=0,this.watchers.finishScanOnce.length=0,this.watchers.onScanOnce.length=0,this.topCD)return this.topCD.destroy()},(u=function(e,t){this.scope=t,this.locals=t,this.root=e,this.watchList=[],this.destroy_callbacks=[],this.parent=null,this.children=[],this.rwatchers={any:[],finishScan:[],elEvents:[]}}).prototype.new=function(e,t){var n,i;return t=t||{},i=this,null==e&&(e=i.scope),(n=new u(i.root,e)).parent=i,e===i.scope&&(t.locals?((t=i._ChildLocals)||(i._ChildLocals=t=function(){return this.$$root=e,this},t.prototype=i.locals),n.locals=new t):n.locals=i.locals),i.children.push(n),n},u.prototype.destroy=function(){var e,t,n,i,a,o,r,s,l,c,u,p,d,f,g,h,m,v,b,y,w,k=this,_=k.root;for(k.scope=null,k.parent&&x(k.parent.children,k),n=0,o=(g=k.destroy_callbacks).length;n<o;n++)(0,g[n])();for(i=0,r=(h=k.children.slice()).length;i<r;i++)h[i].destroy();for(a=k.destroy_callbacks.length=0,s=(m=k.watchList).length;a<s;a++)(e=m[a]).onStop&&e.onStop();for(p=k.watchList.length=0,l=(v=k.rwatchers.any).length;p<l;p++)w=v[p],x(_.watchers.any,w);for(d=k.rwatchers.any.length=0,c=(b=k.rwatchers.finishScan).length;d<c;d++)w=b[d],x(_.watchers.finishScan,w);for(f=k.rwatchers.finishScan.length=0,u=(y=this.rwatchers.elEvents).length;f<u;f++)t=y[f],ce.off(t[0],t[1],t[2]);this.rwatchers.elEvents.length=0,_.topCD===k&&(_.topCD=null,_.destroy())},o=function(e){return this.cb=e},r=function(e,t,n){var i=e.root,a=new o(n);return e.rwatchers[t].push(a),i.watchers[t].push(a),{stop:function(){return x(e.rwatchers[t],a),x(i.watchers[t],a)}}},u.prototype.on=function(e,t,n){return ce.on(e,t,n),this.rwatchers.elEvents.push([e,t,n])},p={$any:function(e,t){return r(e,"any",t)},$finishScan:function(e,t){return r(e,"finishScan",t)},$finishScanOnce:function(e,t){e.root.watchers.finishScanOnce.push(t)},$onScanOnce:function(e,t){e.root.watchers.onScanOnce.push(t)},$destroy:function(e,t){e.destroy_callbacks.push(t)},$finishBinding:function(e,t){e.root.watchers.finishBinding.push(t)}},_=function(){},u.prototype.watch=function(t,n,e){var i,a,o,r,s,l,c,u=p[t];if(u)return u(this,n);if((e=!0===(e=e||{})?{isArray:!0}:e).init&&console.warn("watch.init is depricated"),(i=this).root,c=i.scope,ce.isFunction(t)?(o=t,s=Y.utils.getId(),r=!0):(r=!1,o=null,"::"===(t=t.trim()).slice(0,2)&&(t=t.slice(2),e.oneTime=!0),s=t,s=e.deep?"d#"+s:e.isArray?"a#"+s:"v#"+s),Y.debug.watch&&console.log("$watch",t),s=!1,!r)if(e.watchText)o=e.watchText.fn;else{if((r=Y.utils.compile.expression(t)).filter)return function(t,e,n,i){var a,o=null,r=i.oneTime;i.isArray?o="array":i.deep&&(o="deep"),n||(a={el:i.element,ea:i.elementAttr},n=function(e){P(t.scope,a,e)});for(var s=Y.utils.parsFilter(e.filter),l=[],c=s.result.length-1;0<=c;c--){var u=Y.core.getFilter(s.result[c].name,t),u=Y.core.buildFilterNode(t,s.result[c],u,n);u.watchMode&&(o=u.watchMode),u.onStop&&l.push(u.onStop),n=u.onChange}return i={oneTime:r},"array"===o?i.isArray=!0:"deep"===o&&(i.deep=!0),l.length&&(i.onStop=function(){l.forEach(function(e){return e()}),l.length=0}),t.watch(e.expression,n,i)}(i,r,n,e);s=r.isSimple&&0===r.simpleVariables.length,o=r.fn}return e.deep&&(e.isArray=!1),a={isStatic:s,isArray:Boolean(e.isArray),extraLoop:!e.readOnly,deep:!0===e.deep?10:e.deep,value:_,callback:n,exp:o,src:""+t,onStop:e.onStop||null,el:e.element||null,ea:e.elementAttr||null},s?i.watch("$onScanOnce",function(){return P(c,a,a.exp(c))}):i.watchList.push(a),l={$:a,stop:function(){if(e.onStop)try{e.onStop()}catch(e){Y.exceptionHandler(e,"Error in onStop of watcher: "+t,t)}if(!a.isStatic)return x(i.watchList,a)},refresh:function(){var e=a.exp(i.locals);return e&&a.deep?a.value=Y.utils.clone(e,a.deep):e&&a.isArray?a.value=e.slice():a.value=e}},e.oneTime&&(a.callback=function(e){if(void 0!==e)return l.stop(),n(e)}),l},u.prototype.watchGroup=function(e,t){var n,i,a,o,r,s=this;if(!t&&ce.isFunction(e)&&(t=e,e=null),r=!1,n=function(){if(!r)return r=!0,s.watch("$onScanOnce",function(){return r=!1,t()})},e)for(i=0,o=e.length;i<o;i++)a=e[i],s.watch(a,n);return n},l=window.performance?function(){return Math.floor(performance.now())}:function(){return(new Date).getTime()},k=function(e,t){var n,i,a,o;if(null===e||null===t)return!0;if((o=typeof e)!=typeof t)return!0;if("object"==o){if(e.length!==t.length)return!0;for(n=i=0,a=e.length;i<a;n=++i)if(e[n]!==t[n])return!0}return!1},P=function(e,t,n){t.el?t.ea?t.el.setAttribute(t.ea,n):t.el.nodeValue=n:t.callback.call(e,n)},w=function(e,t,n,i){t={src:n.src,scope:t.scope,locals:t.locals};return n.el&&(t.element=n.el),Y.exceptionHandler(e,(1===i?"$scan, error in callback: ":"$scan, error in expression: ")+n.src,t)},y=function(){},c=function(e,t){e.root;var n,i,a,o,r,s,l,c,u,p,d,f,g,h,m=!1,v=0,b=0;if(e){for(d=[],r=0,a=e;a;){for(u=a.locals,b+=a.watchList.length,s=0,c=(f=a.watchList.slice()).length;s<c;s++){l=(h=f[s]).value;try{g=h.exp(u)}catch(e){o=e,g=y}if(l!==g){if(p=!1,h.isArray?(n=Array.isArray(l))===(i=Array.isArray(g))?n?k(l,g)&&(p=!0,h.value=g.slice()):(p=!0,h.value=g):(p=!0,h.value=i?g.slice():g):h.deep?Y.utils.equal(l,g,h.deep)||(p=!0,h.value=Y.utils.clone(g,h.deep)):(p=!0,h.value=g),p)if(p=!1,g===y)w(o,a,h);else{v++;try{h.el?h.ea?null!=g?h.el.setAttribute(h.ea,g):h.el.removeAttribute(h.ea):h.el.nodeValue=g:(l===_&&(l=void 0),"$scanNoChanges"!==h.callback.call(a.scope,g,l)&&h.extraLoop&&(m=!0))}catch(e){w(o=e,a,h,1)}}1<Y.debug.scan&&console.log("changed:",h.src)}}d.push.apply(d,a.children),a=d[r++]}t.total=b,t.changes=v,t.extraLoop=m}},u.prototype.digest=function(){var e,t,n,i,a,o=this.root,r=10,s=0;for(Y.debug.scan&&(a=l()),i={total:0,changes:0,extraLoop:!1,src:"",scope:null,element:null};r;){if(r--,o.extraLoop=!1,o.watchers.onScanOnce.length)for(n=o.watchers.onScanOnce.slice(),e=o.watchers.onScanOnce.length=0,t=n.length;e<t;e++)n[e].call(o);if(c(this,i),s+=i.changes,!i.extraLoop&&!o.extraLoop&&!o.watchers.onScanOnce.length)break}return Y.debug.scan&&(a=l()-a,console.log("$scan: loops: ("+(10-r)+"), last-loop changes: "+i.changes+", watches: "+i.total+" / "+a+"ms")),i.mainLoop=r,i.totalChanges=s,i},u.prototype.scan=function(e){var t,n,i,a,o,r,s,l,c,u=this.root;if(e=e||{},!Y.option.zone||e.zone){if((e=ce.isFunction(e)?{callback:e}:e).callback&&u.watchers.finishScanOnce.push(e.callback),e.late)return u.lateScan?void 0:(u.lateScan=!0,void Y.nextTick(function(){if(u.lateScan)return u.topCD.scan()}));if("scaning"!==u.status){if(u.lateScan=!1,u.status="scaning",(e=u.topCD?u.topCD.digest():{}).totalChanges)for(n=0,o=(l=u.watchers.any).length;n<o;n++)(0,l[n])();for(u.status=null,i=0,r=(c=u.watchers.finishScan).length;i<r;i++)(0,c[i])();for(t=u.watchers.finishScanOnce.slice(),a=u.watchers.finishScanOnce.length=0,s=t.length;a<s;a++)t[a].call(u);if(0===e.mainLoop)throw"Infinity loop detected";return e}u.extraLoop=!0}},(Y.core.ChangeDetector=u).prototype.compile=function(e,t){return Y.utils.compile.expression(e,t).fn},u.prototype.setValue=function(t,n){var i,a,o,r,s,l,c,u,p=this.compile(t+" = $value",{input:["$value"],no_return:!0});try{return p(this.locals,n)}catch(e){if(i=e,l="can't set variable: "+t,Y.debug.parser&&console.warn(l),0<=(""+i).indexOf("TypeError")&&(u=t.match(/^([\w\d\.]+)\.[\w\d]+$/))&&u[1]){for(s=this.locals,a=0,r=(c=u[1].split(".")).length;a<r;a++)void 0===s[o=c[a]]&&(s[o]={}),s=s[o];try{return void p(this.locals,n)}catch(e){}}return Y.exceptionHandler(i,l,{name:t,value:n})}},u.prototype.eval=function(e){return this.compile(e)(this.locals)},u.prototype.getValue=function(e){return this.eval(e)},Y.text.$base=function(t){var e,n=t.point,i=t.cd,a=i.scope,o=(a.$ns&&a.$ns.text?a.$ns:Y).text[t.name];if(!o)throw"No directive alight.text."+t.name;return e={changeDetector:i,setter:function(e){if(t.update)return n.value=null===e?"":""+e,t.update()},setterRaw:function(e){if(t.updateRaw)return n.value=null===e?"":""+e,t.updateRaw()},finally:function(e){if(t.finally)return n.value=null===e?"":""+e,n.type="text",t.finally(),t.update=null,t.finally=null}},o.call(i,e.setter,t.exp,a,e)},ae=function(e,t,n){var i,a,o,r,s,l,c,u,p,d,f,g,h,m,v,b,y,w,k,_,x,C,S,D,E,$,A;if(n=n||{},a=this,Y.debug.watchText&&console.log("$watchText",e),C=Y.utils.compile.buildSimpleText(e,null))a.watch(e,t,{watchText:C,element:n.element,elementAttr:n.elementAttr});else{for(r=Y.utils.parsText(e),_=!(i=!($=0)),l=c=s=function(){},g=0,v=r.length;g<v;g++)if("expression"===(o=r[g]).type)if(w=(u=o.list.join("|")).match(/^([^\w\d\s\$"'\(\u0410-\u044F\u0401\u0451]+)/))o.isDir=!0,k=w[1],u="#"===k?(f=u.indexOf(" "))<0?(k=u.substring(1),""):(k=u.slice(1,f),u.slice(f)):u.substring(k.length),Y.text.$base({name:k,exp:u,cd:a,point:o,update:function(){return l()},updateRaw:function(){return c()},finally:function(){return l(),s()}}),_=!0,"text"!==o.type&&(i=!1);else if((k=Y.utils.compile.expression(u,{string:!0})).filter)$++,o.watched=!(i=!1),function(t){a.watch(u,function(e){return t.value=e=null==e?"":e,l()})}(o);else{if(o.fn=k.fn,!k.rawExpression)throw"Error";k.isSimple&&0===k.simpleVariables.length?(o.type="text",o.value=o.fn()):(o.re=k.rawExpression,$++)}if(i){if($)return C=_?Y.utils.compile.buildSimpleText(null,r):Y.utils.compile.buildSimpleText(e,r),void a.watch(e,t,{watchText:{fn:C.fn},element:n.element,elementAttr:n.elementAttr});for(D="",h=0,b=r.length;h<b;h++)o=r[h],D+=o.value;a.watch("$onScanOnce",function(){return P(a.scope,{callback:t,el:n.element,ea:n.elementAttr},D)})}else if(A={callback:t,el:n.element,ea:n.elementAttr},r.scope=a.scope,d=Y.utils.compile.buildText(e,r),c=function(){return P(a.scope,A,d())},$){for(E=null,x="",l=function(){x=d()},s=function(){var e,t;for(f=!0,e=0,t=r.length;e<t;e++)if("expression"===(o=r[e]).type){f=!1;break}f&&(a.watch("$finishScanOnce",function(){return E.stop()}),n.onStatic&&n.onStatic())},e=function(){return x},m=0,y=r.length;m<y;m++)"expression"===(o=r[m]).type&&(o.isDir||o.watched||(o.watched=!0,function(t,e){a.watch(e,function(e){return t.value=e=null==e?"":e,l()})}(o,o.list.join(" | "))));l(),E=a.watch(e,t,{element:n.element,elementAttr:n.elementAttr})}else S=!1,p=function(){return S=!1,c()},(l=function(){if(!S)return S=!0,a.watch("$onScanOnce",p)})()}},u.prototype.watchText=ae,C={TR:1,TD:1,LI:1},Y.utils.optmizeElement=function(e,t){var n,i,a,o,r,s,l,c,u,p,d,f,g,h,m,v,b,y,w;if(1===e.nodeType){for(t=t||!Y.option.domOptimizationRemoveEmpty,"PRE"===e.nodeName&&(t=!0),!(o=e.firstChild)||3!==o.nodeType||o.nodeValue.trim()||t||(ce.remove(o),o=e.firstChild),m=!1;o;)g=o.nextSibling,!m||3!==o.nodeType||o.nodeValue.trim()||t?(m=1===o.nodeType&&C[o.nodeName],Y.utils.optmizeElement(o,t)):ce.remove(o),o=g;!(o=e.lastChild)||3!==o.nodeType||o.nodeValue.trim()||t||ce.remove(o)}else if(3===e.nodeType&&(y=e.data,d=Y.utils.pars_start_tag,!((s=y.indexOf(d))<0||y.slice(s+d.length).indexOf(d)<0))){for(h="t",b=[n={value:""}],l=0,u=(a=Y.utils.parsText(y)).length;l<u;l++)"text"===(i=a[l]).type?n.value+=i.value:(r=i.list.join("|"),w=Y.utils.pars_start_tag+r+Y.utils.pars_finish_tag,r.match(/^([^\w\d\s\$"'\(\u0410-\u044F\u0401\u0451]+)/)?("t"===h||"d"===h?n.value+=w:b.push(n={value:w}),h="d"):1===i.list.length?("t"===h||"v"===h?n.value+=w:b.push(n={value:w}),h="v"):"t"===h?n.value+=w:b.push(n={value:w}));if(!(b.length<2))for((o=e).data=b[0].value,c=0,p=(v=b.slice(1)).length;c<p;c++)i=v[c],f=document.createTextNode(i.value),ce.after(o,f),o=f}},Y.hooks.attribute=ae=[],ae.push({code:"dataPrefix",fn:function(){"data-"===this.attrName.slice(0,5)&&(this.attrName=this.attrName.slice(5))}}),ae.push({code:"colonNameSpace",fn:function(){var e,t;this.directive||this.name||((t=(e=(t=this.attrName.match(/^(\w+)[\-\:](.+)$/))?(this.ns=t[1],t[2]):(this.ns="$global",this.attrName)).match(/^([^\.]+)\.(.*)$/))&&(e=t[1],this.attrArgument=t[2]),this.name=e.replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}))}}),ae.push({code:"getGlobalDirective",fn:function(){var e;if(!this.directive){if(!(e=Y.d[this.ns]))return this.result="noNS",void(this.stop=!0);this.directive=e[this.name],this.directive||("$global"===this.ns?this.result="noNS":this.result="noDirective",this.stop=!0)}}}),ae.push({code:"cloneDirective",fn:function(){var e,t,n=this.directive,i=this.ns,a=this.name,o={};if(ce.isFunction(n))o.init=n;else{if(!ce.isObject(n))throw"Wrong directive: "+i+"."+a;for(e in n)t=n[e],o[e]=t}if(o.priority=n.priority||Y.priority[i]&&Y.priority[i][a]||0,o.restrict=n.restrict||"A",o.restrict.indexOf(this.attrType)<0)throw"Directive has wrong binding (attribute/element): "+a;this.directive=o}}),ae.push({code:"preprocessor",fn:function(){var r=this.ns,s=this.name,l=this.directive;l.$init=function(e,t,n,i){var a=function(){for(var e,t=o.procLine,n=e=0,i=t.length;e<i;n=++e)if(t[n].fn.call(o),o.isDeferred){o.procLine=t.slice(n+1);break}return o.async=!0,null},o={element:t,value:n,cd:e,env:i,ns:r,name:s,doBinding:!1,directive:l,isDeferred:!1,procLine:Y.hooks.directive,makeDeferred:function(){return o.isDeferred=!0,o.doBinding=!0,o.retStopBinding=!0,o.async=!1,function(){if(o.isDeferred=!1,o.async)return a()}}};if(l.stopBinding&&(i.stopBinding=!0),a(),o.retStopBinding)return"stopBinding"}}}),(ae=Y.hooks.directive).push({code:"init",fn:function(){var e;this.directive.init&&(Y.debug.directive&&this.directive.scope&&console.warn(this.ns+"-"+this.name+" uses scope and init together, probably you need use link instead of init"),this.env.changeDetector=this.cd,(e=this.directive.init.call(this.env,this.cd.scope,this.element,this.value,this.env))&&e.start&&e.start())}}),ae.push({code:"templateUrl",fn:function(){var t,n=this;this.directive.templateUrl&&(t=this.makeDeferred(),ce.ajax({cache:!0,url:this.directive.templateUrl,success:function(e){return n.directive.template=e,t()},error:t}))}}),ae.push({code:"template",fn:function(){var e;this.directive.template&&(1===this.element.nodeType?this.element.innerHTML=this.directive.template:8===this.element.nodeType&&((e=document.createElement("p")).innerHTML=this.directive.template.trim(),e=e.firstChild,ce.after(this.element,e),this.element=e,this.doBinding=!0))}}),ae.push({code:"scope",fn:function(){var e,t;if(this.directive.scope){switch(t=this.cd,this.directive.scope){case!0:e=t.new({$parent:t.scope});break;case"root":e=Y.ChangeDetector({$parent:t.scope}),t.watch("$destroy",function(){return e.destroy()});break;default:throw"Wrong scope value: "+this.directive.scope}this.env.parentChangeDetector=t,this.cd=e,this.doBinding=!0,this.retStopBinding=!0}}}),ae.push({code:"link",fn:function(){var e;this.directive.link&&(this.env.changeDetector=this.cd,(e=this.directive.link.call(this.env,this.cd.scope,this.element,this.value,this.env))&&e.start&&e.start())}}),ae.push({code:"scopeBinding",fn:function(){this.doBinding&&!this.env.stopBinding&&Y.bind(this.cd,this.element,{skip_attr:this.env.skippedAttr()})}}),s=function(e,t,n){var i;"A"===t.attr_type?((i=n||{}).priority=Y.priority.$attribute,i.is_attr=!0,i.name=e,i.attrName=e,i.element=t.element,t.list.push(i)):"M"===t.attr_type&&t.list.push(n)},j=function(e,t){var n,i,a,o;if(0<=t.skip_attr.indexOf(e))return s(e,t,{skip:!0});for(n={attrName:e,attrType:t.attr_type,element:t.element,cd:t.cd,result:null},i=0,a=(o=Y.hooks.attribute).length;i<a&&(o[i].fn.call(n),!n.stop);i++);if("noNS"!==n.result)return"noDirective"===n.result?"E"===t.attr_type?void t.list.push({name:e,priority:-10,attrName:e,noDirective:!0}):void s(e,t,{noDirective:!0}):void t.list.push({name:e,directive:n.directive,priority:n.directive.priority,attrName:e,attrArgument:n.attrArgument});s(e,t)},T=function(e,t){return e.priority===t.priority?0:e.priority>t.priority?-1:1},B=function(e,t,n,i){if(!(n.indexOf(Y.utils.pars_start_tag)<0))return e.watchText(n,null,{element:t,elementAttr:i}),!0},g=function(e,t,n){var i=t.data;if(!(i.indexOf(Y.utils.pars_start_tag)<0))return e.watchText(i,null,{element:t}),i},d=function(t,n,e){var i,a,o,r=n.nodeValue.trim();if("directive:"===r.slice(0,10)){if(o=0<=(a=(r=r.slice(10).trim()).indexOf(" "))?(i=r.slice(0,+(a-1)+1||9e9),r.slice(a+1)):(i=r,""),r={list:a=[],element:n,attr_type:"M",cd:t,skip_attr:[]},j(i,r),(r=a[0]).noDirective)throw"Comment directive not found: "+i;i=r.directive,a=new A({element:n,attrName:r.attrName,attributes:a}),Y.debug.directive&&console.log("bind",r.attrName,o,r);try{i.$init(t,n,o,a)}catch(e){Y.exceptionHandler(e,"Error in directive: "+r.name,{value:o,env:a,cd:t,scope:t.scope,element:n})}return a.skipToElement?{directive:1,skipToElement:a.skipToElement}:{directive:1,skipToElement:null}}},(A=function(e){var t,n;for(t in e)n=e[t],this[t]=n;return this}).prototype.takeAttr=function(e,t){var n,i,a,o;for(1===arguments.length&&(t=!0),i=0,a=(o=this.attributes).length;i<a;i++)if((n=o[i]).attrName===e)return t&&(n.skip=!0),this.element.getAttribute(e)||!0},A.prototype.skippedAttr=function(){for(var e,t=this.attributes,n=[],i=0,a=t.length;i<a;i++)(e=t[i]).skip&&n.push(e.attrName);return n},A.prototype.scan=function(e){return this.changeDetector.scan(e)},A.prototype.on=function(e,t,n){return this.changeDetector.on(e,t,n)},A.prototype.watch=function(e,t,n){return this.changeDetector.watch(e,t,n)},A.prototype.watchGroup=function(e,t){return this.changeDetector.watchGroup(e,t)},A.prototype.watchText=function(e,t,n){return this.changeDetector.watchText(e,t,n)},A.prototype.getValue=function(e){return this.changeDetector.getValue(e)},A.prototype.setValue=function(e,t){return this.changeDetector.setValue(e,t)},A.prototype.eval=function(e){return this.changeDetector.eval(e)},A.prototype.new=function(e,t){return!0===t?t={locals:!0}:!0===e&&null==t&&(t={locals:!(e=null)}),this.changeDetector.new(e,t)},A.prototype.bind=function(e,t,n){var i,a,o,r,s,l,c;for(this.stopBinding=!0,s=o=0,l=arguments.length;s<l;s++)(i=arguments[s])instanceof u&&(a=i,o+=1),ce.isElement(i)&&(r=i,o+=1);return c=(c=arguments[o])||{skip:this.skippedAttr()},r=r||this.element,a=a||this.changeDetector,Y.bind(a,r,c)},f=function(t,a,e){var n,i,o,r,s,l,c,u,p,d,f,g,h,m,v,b,y,w,k,_,x,C,S,D={attr:[],dir:[],children:[]},E={directive:0,hook:0,skipToElement:null,fb:D},$=(e=e||{}).skip_attr;if(!(x=!1)===e.skip?e.skip_top=!0:$=$||(e.skip||[]),$ instanceof Array||($=[$]),!e.skip_top){for(n={list:v=[],element:a,skip_attr:$,attr_type:"E",cd:t},o=a.nodeName.toLowerCase(),j(o,n),"script"!==o&&"style"!==o||(x=!0),n.attr_type="A",f=0,g=(k=a.attributes).length;f<g;f++)i=k[f],j(i.name,n);if(e.attachDirective)for(o in _=e.attachDirective)_[o],j(o,n);for(b=0,h=(v=v.sort(T)).length;b<h;b++)if(!(c=v[b]).skip){if(c.noDirective)throw"Directive not found: "+c.name;if(c.skip=!0,S=e.attachDirective&&e.attachDirective[c.attrName]?e.attachDirective[c.attrName]:a.getAttribute(c.attrName),c.is_attr)B(t,a,S,c.attrName)&&D.attr.push({attrName:c.attrName,value:S});else{p=c.directive,u=new A({element:a,attrName:c.attrName,attrArgument:c.attrArgument||null,attributes:v,stopBinding:!1,elementCanBeRemoved:e.elementCanBeRemoved,fbElement:e.fbElement}),Y.debug.directive&&console.log("bind",c.attrName,S,c);try{"stopBinding"===p.$init(t,a,S,u)&&(x=!0)}catch(e){Y.exceptionHandler(e,"Error in directive: "+c.attrName,{value:S,env:u,cd:t,scope:t.scope,element:a})}if(u.fastBinding?(p=ce.isFunction(u.fastBinding)?u.fastBinding:p.init,D.dir.push({fb:p,attrName:c.attrName,value:S,attrArgument:u.attrArgument,fbData:u.fbData})):E.directive++,u.stopBinding){x=!0;break}u.skipToElement&&(E.skipToElement=u.skipToElement)}}}if(!x)for(C=null,d=y=0,m=(s=function(){for(var e=a.childNodes,t=[],n=0,i=e.length;n<i;n++)r=e[n],t.push(r);return t}()).length;y<m;d=++y)(r=s[d])&&(C?C===r&&(C=null):(e.fbElement&&(l={fbElement:e.fbElement.childNodes[d]}),w=L(t,r,l),E.directive+=w.directive,E.hook+=w.hook,C=w.skipToElement,w.fb&&(w.fb.text||w.fb.attr&&w.fb.attr.length||w.fb.dir&&w.fb.dir.length||w.fb.children&&w.fb.children.length)&&D.children.push({index:d,fb:w.fb})));return E},L=function(e,t,n){var i,a,o,r,s,l,c={directive:0,hook:0,skipToElement:null,fb:null};if(Y.hooks.binding.length)for(a=0,o=(s=Y.hooks.binding).length;a<o;a++)if(i=s[a],c.hook+=1,(r=i.fn(e,t,n))&&r.owner)return c;return 1===t.nodeType?(r=f(e,t,n),c.directive+=r.directive,c.hook+=r.hook,c.skipToElement=r.skipToElement,c.fb=r.fb):3===t.nodeType?(l=g(e,t))&&(c.fb={text:l}):8===t.nodeType&&(r=d(e,t))&&(c.directive+=r.directive,c.skipToElement=r.skipToElement),c},Y.nextTick=(h=null,m=[],v=function(){var t,e,n,i,a;for(h=null,e=m.slice(),n=m.length=0,i=e.length;n<i;n++){t=(a=e[n])[0],a=a[1];try{t.call(a)}catch(e){Y.exceptionHandler(e,"$nextTick, error in function",{fn:t,self:a})}}return null},function(e){if(m.push([e,this]),!h)return h=setTimeout(v,0)}),Y.bind=function(e,t,n){var i,a,o,r,s;if(!e)throw"No changeDetector";if(!t)throw"No element";if(n=n||{},Y.option.domOptimization&&!n.noDomOptimization&&Y.utils.optmizeElement(t),(i=!(s=e.root).finishBinding_lock)&&(s.finishBinding_lock=!0,s.bindingResult={directive:0,hook:0}),n=L(e,t,n),s.bindingResult.directive+=n.directive,s.bindingResult.hook+=n.hook,e.digest(),i){for(s.finishBinding_lock=!1,r=s.watchers.finishBinding.slice(),a=s.watchers.finishBinding.length=0,o=r.length;a<o;a++)(0,r[a])();n.total=s.bindingResult}return n},b=Y.bind,Y.bind=function(e,t,n){var i=e.root,a=Y.option.zone;if(a){var o=!0===a?Zone:a,a=i.zone;if(a||(i.zone=a=o.current.fork({name:o.current.name+".x",properties:{root:i},onInvokeTask:pe})),o.current!==a)return i.zone.run(b,null,[e,t,n])}return b(e,t,n)},Y.bootstrap=function(e,t){if(!e)return Y.bootstrap("[al-app]"),Y.bootstrap("[al\\:app]"),void Y.bootstrap("[data-al-app]");var n,i;if(e instanceof Y.core.ChangeDetector?(i=e,e=t):t instanceof Y.core.ChangeDetector?i=t:ce.isFunction(t)?(i=Y.ChangeDetector(n={}),t.call(i,n)):t&&(i=Y.ChangeDetector(t)),Array.isArray(e)){for(var a=void 0,o=0,r=e;o<r.length;o++){var s=r[o];a=Y.bootstrap(s,i)}return a}if("string"==typeof e){for(var a=void 0,l=0,c=document.querySelectorAll(e);l<c.length;l++){var u=c[l];a=Y.bootstrap(u,i)}return a}if(i=i||Y.ChangeDetector(),ce.isElement(e)){for(var p,d,f,g=0,h=["al-app","al:app","data-al-app"];g<h.length&&(d=e.getAttribute(p=h[g]),e.removeAttribute(p),!d);g++);return d&&(f={skip_attr:[p],attachDirective:{}},Y.d.al.ctrl?f.attachDirective["al-ctrl"]=d:f.attachDirective[d+"!"]=""),Y.bind(i,e,f),i}Y.exceptionHandler("Error in bootstrap","Error input arguments",{input:e})},Y.utils.getId=(E=function(){for(var e,t,n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=Math.floor((new Date).valueOf()/1e3)-1388512800,a="";0<i;)t=i-62*(e=Math.floor(i/62)),i=e,a=n[t]+a;return a}(),$=1,function(){return E+"#"+$++}),Y.utils.clone=S=function(i,a){var o,e,t,n;if((a=null==a?128:a)<1)return null;if(!i)return i;if("object"!=typeof i)return i;if(i instanceof Array)return t=function(){for(var e=[],t=0,n=i.length;t<n;t++)o=i[t],e.push(S(o,a-1));return e}();if(i instanceof Date)return new Date(i.valueOf());if(i.nodeType&&"function"==typeof i.cloneNode)return i;for(e in t={},i)n=i[e],"$"!==e[0]&&(t[e]=S(n,a-1));return t},Y.utils.equal=D=function(e,t,n){var i,a,o,r,s,l,c;if((n=null==n?128:n)<1)return!0;if(!e||!t)return e===t;if((l=typeof e)!=typeof t)return!1;if("object"!=l)return e===t;if(e instanceof Array){if(e.length!==t.length)return!1;for(i=a=0,r=e.length;a<r;i=++a)if(c=e[i],!D(c,t[i],n-1))return!1;return!0}if(e instanceof Date)return e.valueOf()===t.valueOf();if(e.nodeType&&"function"==typeof e.cloneNode)return e===t;for(o in s={},e)if(c=e[o],"$"!==o[0]&&(s[o]=!0,!D(c,t[o],n-1)))return!1;for(o in t)if(c=t[o],"$"!==o[0]&&!s[o]&&!D(c,e[o],n-1))return!1;return!0},Y.exceptionHandler=function(e,t,n){var i=[];return t&&i.push(t),e&&e.message&&i.push(e.message),n&&i.push(n),e&&i.push(e.stack||e),console.error.apply(console,i)},z=(V=function(){for(var e={},t=0,n=arguments.length;t<n;t++)e[arguments[t]]=!0;return e})("instanceof","typeof","in","null","true","false","undefined","return"),M=/[a-zA-Z\u0410-\u044F\u0401\u0451_\.\$]/,N=function(e){return e.match(M)},O=function(e){return 48<=e.charCodeAt()&&e.charCodeAt()<=57},H=V("+","-",">","<","=","&","|","^","!","~"),I=function(e){return H[e]||!1},F=V("=","+=","-=","++","--","|=","^=","&=","!=","<<=",">>="),Y.utils.parsExpression=function(e,t){var f,g,c,_,h,u,m=V.apply(null,(t=t||{}).input||[]),x=1,t=(_=function(e){for(var t,n,i,a,o=e.line,r=e.result||[],s=e.index||0,l=e.level||0,c=e.stopKey||null,u="",p=null,d=[],f="",g="",h=!1,m="",v="",b="",y=0,w=null,k=function(){return b&&r.push({type:"free",value:b}),b=""};s<=o.length;)if(i=o[s-1],t=o[s++]||"",n=o[s],(h&&b||!t)&&k(),"string"!==h){if("key"===h){if(N(t)||O(t)){u+=t;continue}if("["===t){if(u+=t,!(a=_({line:o,index:s,level:l+1,stopKey:"]"})).stopKeyOk)throw"Error expression";s=a.index,u+="###"+a.uniq+"###]",d.push(a);continue}if("?"===t&&("."===n||"("===n||"["===n)){u+=t;continue}if("("===t){if(u+=t,!(a=_({line:o,index:s,level:l+1,stopKey:")"})).stopKeyOk)throw"Error expression";s=a.index,u+="###"+a.uniq+"###)",d.push(a);continue}p={type:"key",value:u,start:s-u.length-1,finish:s-1,children:d},r.push(p),u=h="",d=[]}else if("sign"===h){if(I(t)){f+=t;continue}if("|"===f&&0===l&&0===y){w=o.substring(s-1),s=o.length+1;continue}(F[f]||"="===f[0]&&"="!==f[1])&&(p.assignment=!0),r.push({type:"sign",value:f}),f=h=""}else if("digit"===h){if(O(t)||"."===t){g+=t;continue}r.push({type:"digit",value:g}),g=""}if(N(t))h="key",u+=t;else if(I(t))h="sign",f+=t;else if(O(t))h="digit",g+=t;else if('"'!==t&&"'"!==t){if(t===c)return k(),{result:r,index:s,stopKeyOk:!0,uniq:x++};"("===t&&y++,")"===t&&y--,"{"!==t?(":"===t&&"}"===c&&(p.type="free"),b+=t):(k(),a=_({line:o,index:s,level:l+1,stopKey:"}"}),r.push({type:"{}",child:a}),s=a.index)}else h="string",v+=m=t}else t!==m||"\\"===i?v+=t:(r.push({type:"string",value:v+=t}),h=m=v="");return k(),{result:r,index:s,filter:w}})({line:e}),v={isSimple:!t.filter,simpleVariables:[]};return t.filter?(v.expression=e.substring(0,e.length-t.filter.length-1),v.filter=t.filter):v.expression=e,h=function(e){e=e.split(/[\.\[\(\?]/);return{count:e.length,firstPart:e[0]}},u=function(e,t){return t?"($$="+e+",$$==null)?undefined:":"($$=$$"+e+",$$==null)?undefined:"},c=function(e){return e.split(/[\.\[\(\?]/)[0]},g=function(e){var t,n,i,a,o,r,s,l;if("this"===e)return"$$scope";if(r=c(e),i=z[r]||m[r],"this"===r&&(e="$$scope"+e.slice(4),i=!0),1===(r=e.split("?")).length)return i?e:"$$scope."+e;for(t=i?(l=u(r[0],!0),r[0]):(l=u("scope."+r[0]),"scope."+r[0]),n=0,a=(s=r.slice(1,r.length-1)).length;n<a;n++)"("===(o=s[n])[0]?l+=u(t+o,i):(l+=u(o),t+=o);return"("===(r=r[r.length-1])[0]?(i||(l+="$$"),l+=t+r):l+="$$"+r,"("+l+")"},f=function(e){for(var t,n,i,a,o,r,s,l,c="",u=e.result,p=0,d=u.length;p<d;p++)if("key"!==(n=u[p]).type)"{}"!==n.type?c+=n.value:c+="{"+f(n.child)+"}";else{if(n.assignment?(r="this"===(l=h(n.value)).firstPart?"$$scope"+n.value.substring(4):m[l.firstPart]?n.value:l.count<2?"($$scope.$$root || $$scope)."+n.value:"$$scope."+n.value,v.isSimple=!1):z[n.value]?r=n.value:(r=g(n.value),v.simpleVariables.push(r)),n.children.length)for(i=0,o=(s=n.children).length;i<o;i++)a="###"+(t=s[i]).uniq+"###",t=f(t),r=r.split(a).join(t);c+=r}return c},v.result=f(t),Y.debug.parser&&console.log(e,v),v},Y.utils.parsFilter=function(e){var t,n,i=[];for(e=e.trim();e;){if(!(t=e.match(/^(\w+)([^\w])(.*)$/))){if(!(t=e.match(/^(\w+)$/)))return null;i.push({name:t[1],args:[],raw:""});break}e="|"===t[2]?(i.push({name:t[1],args:[],raw:""}),t[3]):(n=Y.utils.parsArguments(t[3],{stop:"|"}),i.push({name:t[1],args:n.result,raw:t[3].slice(0,n.length)}),t[3].slice(n.length+1).trim())}return{result:i}},Y.utils.parsArguments=function(e,t){var n,i,a,o,r,s,l,c;for(t=t||{},i="",o=r=0,c=l=!(a=[]),s=function(){i&&(a.push(i),i="")};r<=e.length;)if(n=e[r]||"",r++,l)i+=n,'"'===n&&(l=!1);else if(c)i+=n,"'"===n&&(c=!1);else if('"'!==n)if("'"!==n)if(o)i+=n,"("===n&&o++,")"===n&&o--;else if(" "!==n&&","!==n){if(t.stop&&t.stop===n){s();break}"("===n&&(o=1),i+=n}else s();else i+=n,c=!0;else i+=n,l=!0;return s(),{result:a,length:r-1}},Y.utils.pars_start_tag="{{",Y.utils.pars_finish_tag="}}",U=function(r){var a=Y.utils.pars_start_tag,s=Y.utils.pars_finish_tag,l=[],c=0,t=0,u=function(e){e=r.substring(t,c-(e=e||1));return t=c,e},p=null,d=function(e,t,n){var i,a,o;for(e||(p={type:"expression",list:[]},l.push(p)),i=null;c<r.length;){if(a=i+(i=r[c]),o=r[c+=1],i===t)return;if(!n){if(a===s&&0===e)return p.list.push(u(2)),!0;"("===i?d(e+1,")"):"{"===i?d(e+1,"}"):'"'===i?d(e+1,'"',!0):"'"===i?d(e+1,"'",!0):"|"===i&&0===e&&("|"===o?c+=1:p.list.push(u()))}}};return function(){for(var e,t,n,i=null;c<r.length;)if(n=i,i=r[c],c+=1,n+i===a){if((t=u(2))&&l.push({type:"text",value:t}),!d(0))throw"Wrong expression"+r;i=null}if(e=u(-1))return l.push({type:"text",value:e})}(),Y.debug.parser&&console.log("parsText",l),l},R={},W=function(i){var a,o;return function(){for(var e=[],t=0,n=i.length;t<n;t++)a=i[t],o={type:a.type,value:a.value},a.list&&(o.list=a.list.slice()),e.push(o);return e}()},Y.utils.parsText=function(e){var t=R[e];return t||(R[e]=t=U(e)),W(t)},Y.utils.compile=J={},J.cache={},J.Function=Function,J.expression=function(t,n){var e,i,a,o,r,s;if(n=n||{},r=(t=t.trim())+"#",r+=n.no_return?"+":"-",r+=n.string?"s":"v",n.input&&(r+=n.input.join(",")),o=J.cache[r])return o;i=(o=Y.utils.parsExpression(t,{input:n.input})).result,n.no_return||!1?s="var $$;"+i:n.string&&!o.filter?(s="var $$, __ = ("+i+"); return '' + (__ || (__ == null?'':__))",o.rawExpression="(__="+i+") || (__ == null?'':__)"):s="var $$;return ("+i+")";try{a=n.input?((e=n.input.slice()).unshift("$$scope"),e.push(s),J.Function.apply(null,e)):J.Function("$$scope",s)}catch(e){throw Y.exceptionHandler(e,"Wrong expression: "+t,{src:t,cfg:n}),"Wrong expression: "+i}return o.fn=a,J.cache[r]=o},J.cacheText={},J.buildText=function(e,t){var n,i,a,o,r,s=J.cacheText[e];if(s)return function(){return s.call(t)};for(r=[],a=i=0,o=t.length;i<o;a=++i)"expression"===(n=t[a]).type?n.fn?r.push("this["+a+"].fn(this.scope)"):r.push("((x=this["+a+"].value) || (x == null?'':x))"):n.value&&(n=n.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),r.push('"'+n+'"'));return r=r.join(" + "),s=J.Function("var x; return ("+r+")"),J.cacheText[e]=s,function(){return s.call(t)}},J.cacheSimpleText={},J.buildSimpleText=function(e,t){var n,i,a,o,r,s,l=e?J.cacheSimpleText[e]:null;if(l||!t)return l||null;for(r=[],s=[],a=i=0,o=t.length;i<o;a=++i)"expression"===(n=t[a]).type?(r.push("("+n.re+")"),n.simpleVariables&&s.push.apply(s,n.simpleVariables)):n.value&&(n=n.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n"),r.push('"'+n+'"'));return r=r.join(" + "),l={fn:J.Function("$$scope","var $$, __; return ("+r+")"),simpleVariables:s},e&&(J.cacheSimpleText[e]=l),l},q=function(e){var t,n,i;if(!e.length)return"el";for(i="el",t=0,n=e.length;t<n;t++)i+=".childNodes["+e[t]+"]";return i},X=function(e){for(var t,n,i=Y.utils.parsText(e),a=0,o=i.length;a<o;a++)if("expression"===(t=i[a]).type){if(1<t.list.length)return null;if("#"===(n=t.list[0])[0])return null;if("="===n[0])return null;if("::"===n.slice(0,2))return null;if(!(n=Y.utils.compile.expression(n,{string:!0})).rawExpression)throw"Error";t.re=n.rawExpression}return Y.utils.compile.buildSimpleText(e,i).fn},Y.core.fastBinding=function(e){if(Y.option.fastBinding&&!e.directive&&!e.hook&&e.fb)return new K(e)},(K=function(e){var b,y,w=this,k=[];return w.fastWatchFn=[],b=[],(y=function(e,t){var n,i,a,o,r,s,l,c,u,p,d,f,g,h,m,v;if(e.dir)for(h=q(b),o=0,c=(d=e.dir).length;o<c;o++)n=d[o],k.push("s.dir("+w.fastWatchFn.length+", "+h+");"),w.fastWatchFn.push(n);if(e.attr)for(r=0,u=(f=e.attr).length;r<u;r++)v=(a=f[r]).value,s=a.attrName,h=q(b),i=X(v),m=v.replace(/"/g,'\\"').replace(/\n/g,"\\n"),i?(k.push('s.fw("'+m+'", '+w.fastWatchFn.length+", "+h+', "'+s+'");'),w.fastWatchFn.push(i)):k.push("s.wt('"+m+"', "+h+", '"+s+"');");if(e.text&&(h=q(b),i=X(e.text),m=e.text.replace(/"/g,'\\"').replace(/\n/g,"\\n"),i?(k.push('s.fw("'+m+'", '+w.fastWatchFn.length+", "+h+");"),w.fastWatchFn.push(i)):k.push('s.wt("'+m+'", '+h+");")),e.children)for(l=0,p=(g=e.children).length;l<p;l++)a=g[l],b.length=t+1,b[t]=a.index,y(a.fb,t+1)})(e.fb,0),k=k.join("\n"),w.resultFn=Y.utils.compile.Function("s","el","f$",k),this}).prototype.bind=function(e,t){this.currentCD=e,this.resultFn(this,t,ce)},K.prototype.dir=function(e,t){var n=this.fastWatchFn[e],i=this.currentCD,e=new A({attrName:n.attrName,attrArgument:n.attrArgument,changeDetector:i,fbData:n.fbData}),e=n.fb.call(e,i.scope,t,n.value,e);e&&e.start&&e.start()},K.prototype.fw=function(e,t,n,i){var a=this.currentCD,o=this.fastWatchFn[t],t=o(a.locals),i={isStatic:!1,isArray:!1,extraLoop:!1,deep:!1,value:t,callback:null,exp:o,src:e,onStop:null,el:n,ea:i||null};a.watchList.push(i),P(a.scope,i,t)},K.prototype.wt=function(e,t,n){this.currentCD.watchText(e,null,{element:t,elementAttr:n})},Y.hooks.attribute.unshift({code:"events",fn:function(){var e=this.attrName.match(/^\@([\w\.\-]+)$/);e&&(this.ns="al",this.name="on",this.attrArgument=e[1])}}),Y.hooks.eventModifier={},(ae=function(e,n){return Y.hooks.eventModifier[e]={event:["keydown","keypress","keyup"],fn:function(e,t){e[n]||(t.stop=!0)}}})("alt","altKey"),ae("control","ctrlKey"),ae("ctrl","ctrlKey"),ae("meta","metaKey"),ae("shift","shiftKey"),Y.hooks.eventModifier.self=function(e,t){if(e.target!==t.element)return t.stop=!0},Y.hooks.eventModifier.once={beforeExec:function(e,t){return t.unbind()}},Q=function(e,t){var n,i,a,o,r,s={};if("string"==typeof e?s.event=e:"object"==typeof e&&e.event&&(s.event=e.event),"string"==typeof s.event&&(s.event=s.event.split(/\s+/)),t&&s.event){for(a=!1,i=0,o=(r=s.event).length;i<o;i++)if(n=r[i],0<=t.indexOf(n)){a=!0;break}if(!a)return null}return ce.isFunction(e)?s.fn=e:e.fn&&(s.fn=e.fn),e.beforeExec&&(s.beforeExec=e.beforeExec),e.init&&(s.init=e.init),s},Y.d.al.on=function(e,t,n,i){var u,a;i.attrArgument&&(Y.option.removeAttribute&&(t.removeAttribute(i.attrName),i.fbElement&&i.fbElement.removeAttribute(i.attrName)),a=i.attrArgument.split(".")[0],(u=function(){}).prototype=ie(i.attrArgument,G[a]),n&&(u.prototype.fn=i.changeDetector.compile(n,{no_return:!0,input:["$event","$element","$value"]})),u.prototype.expression=n,i.fastBinding=function(e,i,t,n){var a,o,r,s,l,c=new u;for(c.scope=e,c.element=i,c.cd=n.changeDetector,a=function(e){return te(c,e)},r=0,s=(l=c.eventList).length;r<s;r++)o=l[r],ce.on(i,o,a);c.initFn&&c.initFn(e,i,t,n),c.unbind=function(){for(var e=c.eventList,t=0,n=e.length;t<n;t++)o=e[t],ce.off(i,o,a)},n.changeDetector.watch("$destroy",c.unbind)},i.fastBinding(e,t,n,i))},ne={enter:13,tab:9,delete:46,backspace:8,esc:27,space:32,up:38,down:40,left:37,right:39},G={click:{stop:!0,prevent:!0},dblclick:{stop:!0,prevent:!0},submit:{stop:!0,prevent:!0},keyup:{filterByKey:!0},keypress:{filterByKey:!0},keydown:{filterByKey:!0}},ie=function(e,t){var n,i,a,o,r,s,l={attrArgument:e,throttle:null,throttleTime:0,debounce:null,debounceId:null,initFn:null,eventList:null,stop:(t=t||{}).stop||!1,prevent:t.prevent||!1,scan:!0,modifiers:[]},e=(n=e.split("."))[0],c=null;for((r=Y.hooks.eventModifier[e])&&(r=Q(r)).event&&(l.eventList=r.event,r.fn&&l.modifiers.push(r),r.init&&(l.initFn=r.init)),l.eventList||(l.eventList=[e]),i=0,o=(s=n.slice(1)).length;i<o;i++)"stop"!==(a=s[i])?"prevent"!==a?"nostop"!==a?"noprevent"!==a?"noscan"!==a?"throttle-"!==a.substring(0,9)?"debounce-"!==a.substring(0,9)?(r=Y.hooks.eventModifier[a])?(r=Q(r,l.eventList))&&l.modifiers.push(r):t.filterByKey&&((c=null===c?{}:c)[a=ne[a]?ne[a]:a]=!0):l.debounce=Number(a.substring(9)):l.throttle=Number(a.substring(9)):l.scan=!1:l.prevent=!1:l.stop=!1:l.prevent=!0:l.stop=!0;return l.filterByKey=c,l},ee=function(e,t){e=e.element;return"checkbox"===e.type?e.checked:"radio"===e.type?e.value||e.checked:(t.component?t:e).value},Z=function(t,n){for(var e,i=t.modifiers,a=0,o=i.length;a<o;a++)(e=i[a]).beforeExec&&e.beforeExec(n,t);if(t.fn)try{t.fn(t.cd.locals,n,t.element,ee(t,n))}catch(e){Y.exceptionHandler(e,"Error in event: "+t.attrArgument+" = "+t.expression,{attr:t.attrArgument,exp:t.expression,scope:t.scope,cd:t.cd,element:t.element,event:n})}t.scan&&t.cd.scan()},te=function(e,t){var n,i,a,o,r,s;if(!e.filterByKey||e.filterByKey[t.keyCode]){if(e.modifiers.length)for((n=function(){}).prototype=e,(i=new n).stop=!1,a=0,o=(s=e.modifiers).length;a<o;a++)if((r=s[a]).fn&&(r.fn(t,i),i.stop))return;e.prevent&&t.preventDefault(),e.stop&&t.stopPropagation(),e.debounce?(e.debounceId&&clearTimeout(e.debounceId),e.debounceId=setTimeout(function(){return e.debounceId=null,Z(e,t)},e.debounce)):e.throttle?e.throttleTime<Date.now()&&(e.throttleTime=Date.now()+e.throttle,Z(e,t)):Z(e,t)}},Y.hooks.attribute.unshift({code:"directDirective",fn:function(){var l,e=this.attrName.match(/^(.*)\!$/);e&&(e=e[1].replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}),l=this.cd.locals[e]||Y.ctrl[e]||Y.option.globalController&&window[e],ce.isFunction(l)?this.directive=function(e,t,n,i){var a=i.changeDetector;if(n){for(var o=Y.utils.parsArguments(n),r=Array(o.result.length),s=0;s<o.result.length;s++)r[s]=Y.utils.compile.expression(o.result[s],{input:["$element","$env"]}).fn(a.locals,t,i);l.apply(a,r)}else l.call(a,e,t,n,i)}:(this.result="noDirective",this.stop=!0))}}),Y.hooks.attribute.unshift({code:"elementVariable",fn:function(){var e=this.attrName.match(/^#([\w\.]*)$/);e&&(this.directive=de,this.attrArgument=e[1])}}),Y.d.al.value=function(e,t,n,i){var a,o;return i.fastBinding=!0,a=function(){i.setValue(n,t.value),o.refresh(),i.scan()},i.on(t,"input",a),i.on(t,"change",a),o=i.watch(n,function(e){return t.value=e=null==e?"":e,"$scanNoChanges"})},Y.d.al.checked=function(e,n,t,i){var a=i.fbData={opt:{},watch:[]};function o(e){var t=i.takeAttr(e);return Y.option.removeAttribute&&(n.removeAttribute(e),i.fbElement&&i.fbElement.removeAttribute(e)),t}function r(e,t){var n=o(t);if(n)return a.opt[e]=n,1;t=o(":"+t)||o("al-attr."+t);return t&&(a.watch.push([t,e]),1)}function l(n,i,a){for(var e in i.fbData.opt)n[e]=i.fbData.opt[e];for(var t=0,o=i.fbData.watch;t<o.length;t++)!function(e){var t=e[1];i.watch(e[0],function(e){n[t]=e,a()})}(o[t])}r("value","value")?i.fastBinding=function(e,t,n,i){var a,o=null;function r(){return t.checked=o&&0<=o.indexOf(s.value),"$scanNoChanges"}var s={};l(s,i,r),a=i.watch(n,function(e){o=e,Array.isArray(o)||(o=null),r()},{isArray:!0}),i.on(t,"change",function(){var e;o||(o=[],i.setValue(n,o)),t.checked?o.indexOf(s.value)<0&&o.push(s.value):0<=(e=o.indexOf(s.value))&&o.splice(e,1),a.refresh(),i.scan()})}:(r("true","true-value"),r("false","false-value"),i.fastBinding=function(e,t,n,i){var a,o,r={true:!0,false:!1};function s(){return t.checked=a===r.true,"$scanNoChanges"}l(r,i,s),o=i.watch(n,function(e){a=e,s()}),i.on(t,"change",function(){a=t.checked?r.true:r.false,i.setValue(n,a),o.refresh(),i.scan()})}),i.fastBinding(e,n,t,i)},Y.d.al.if=function(e,t,n,i){var a;return i.elementCanBeRemoved?(Y.exceptionHandler(null,i.attrName+" can't control element because of "+i.elementCanBeRemoved,{scope:e,element:t,value:n,env:i}),{}):(i.stopBinding=!0,a={item:null,childCD:null,base_element:null,top_element:null,start:function(){a.prepare(),a.watchModel()},prepare:function(){a.base_element=t,a.top_element=document.createComment(" "+i.attrName+": "+n+" "),ce.before(t,a.top_element),ce.remove(t)},updateDom:function(e){e?a.insertBlock(e):a.removeBlock()},removeBlock:function(){a.childCD&&(a.childCD.destroy(),a.childCD=null,a.removeDom(a.item),a.item=null)},insertBlock:function(){a.childCD||(a.item=a.base_element.cloneNode(!0),a.insertDom(a.top_element,a.item),a.childCD=i.changeDetector.new(),Y.bind(a.childCD,a.item,{skip_attr:i.skippedAttr(),elementCanBeRemoved:i.attrName}))},watchModel:function(){i.watch(n,a.updateDom)},removeDom:function(e){ce.remove(e)},insertDom:function(e,t){ce.after(e,t)}})},Y.d.al.ifnot=function(e,t,n,i){var a=Y.d.al.if(e,t,n,i);return a.updateDom=function(e){e?a.removeBlock():a.insertBlock()},a},Y.directives.al.repeat={restrict:"AM",init:function(e,C,o,W){var s,U;return W.elementCanBeRemoved?(Y.exceptionHandler(null,W.attrName+" can't control element because of "+W.elementCanBeRemoved,{scope:e,element:C,value:o,env:W}),{}):(W.stopBinding=!0,s=W.changeDetector,U={start:function(){U.parsExpression(),U.prepareDom(),U.buildUpdateDom(),U.watchModel()},parsExpression:function(){var e,t=o.trim();if("("===t[0])if(U.objectMode=!0,e=t.match(/\((\w+),\s*(\w+)\)\s+in\s+(.+)\s+orderBy:(.+)\s*$/))U.objectKey=e[1],U.objectValue=e[2],U.expression=e[3]+(" | toArray:"+U.objectKey+","+U.objectValue+" | orderBy:"+e[4]),U.nameOfKey="$item",U.trackExpression="$item."+U.objectKey;else{if(!(e=t.match(/\((\w+),\s*(\w+)\)\s+in\s+(.+)\s*$/)))throw"Wrong repeat: "+o;U.objectKey=e[1],U.objectValue=e[2],U.expression=e[3]+(" | toArray:"+U.objectKey+","+U.objectValue),U.nameOfKey="$item",U.trackExpression="$item."+U.objectKey}else{if((e=t.match(/(.*) track by ([\w\.\$\(\)]+)/))&&(U.trackExpression=e[2],t=e[1]),!(e=t.match(/\s*(\w+)\s+in\s+(.+)/)))throw"Wrong repeat: "+o;U.nameOfKey=e[1],U.expression=e[2]}},watchModel:function(){var e=U.objectMode?{deep:!0}:{isArray:!0};U.watch=s.watch(U.expression,U.updateDom,e)},prepareDom:function(){var e,t,n,i,a;if(8===C.nodeType){for(U.top_element=C,U.element_list=t=[],e=C.nextSibling;e;){if(8===e.nodeType&&"/directive:"===(a=e.nodeValue.trim().split(/\s+/))[0]&&"al-repeat"===a[1]){W.skipToElement=e;break}t.push(e),e=e.nextSibling}for(n=0,i=t.length;n<i;n++)e=t[n],ce.remove(e)}else U.base_element=C,U.top_element=document.createComment(" "+o+" "),ce.before(C,U.top_element),ce.remove(C),Y.option.removeAttribute&&C.removeAttribute(W.attrName)},makeChild:function(e,t,n){var i=s.new(null,{locals:!0});return U.updateLocals(i,e,t,n),i},updateLocals:function(e,t,n,i){e=e.locals;U.objectMode?(e[U.objectKey]=t[U.objectKey],e[U.objectValue]=t[U.objectValue]):e[U.nameOfKey]=t,e.$index=n,e.$first=0===n,e.$last=n===i.length-1},rawUpdateDom:function(e,t){for(var n,i,a,o,r=0,s=e.length;r<s;r++)n=e[r],ce.remove(n);for(a=0,o=t.length;a<o;a++)i=t[a],ce.after(i.after,i.element)},buildUpdateDom:function(){return U.updateDom=(M=[],_=null,x=H=0,V=W.skippedAttr(),z="$index"===U.trackExpression?(a={},I=function(e){return a[H]||null},O=function(e){null!=e.$id&&delete a[e.$id]},function(e,t){t.$id=H,a[H]=t}):U.trackExpression?(a={},o=s.compile(U.trackExpression,{input:["$id",U.nameOfKey]}),n=function(e,t){return o(s.scope,e,t)},i=function(e){var t=e.$alite_id;return t=t||(e.$alite_id=Y.utils.getId())},I=function(e){e=n(i,e);return null!=e?a[e]:null},O=function(e){e=e.$id;null!=e&&delete a[e]},function(e,t){e=n(i,e);t.$id=e,a[e]=t}):window.Map?(a=new Map,I=function(e){return a.get(e)},O=function(e){a.delete(e.item)},function(e,t){a.set(e,t)}):(a={},I=function(e){return"object"!=typeof e?a[e]||null:(e=e.$alite_id)?a[e]:null},O=function(e){var t=e.$id;a[t]&&(e.$id=null,delete a[t])},function(e,t){var n;"object"==typeof e?(n=Y.utils.getId(),e.$alite_id=n,t.$id=n,a[n]=t):(t.$id=e,a[e]=t)}),r=[],R=function(e){var t,n=typeof e;if("object"==n)return e&&e.length?e:[];if("number"==n)t=Math.floor(e);else if("string"==n&&(t=Math.floor(e),isNaN(t)))return[];if(t<r.length)r.length=t;else for(;r.length<t;)r.push(r.length);return r},U.element_list?function(e){for(var a,o,r,t,s,n,i,l,c,u,p,d,f,g,h,m,v,b,y,w,k,_,x,C,S,D,E,$,A,P,B=R(e),L=U.top_element,T=[],j=[],F=0,N=M.length;F<N;F++)(x=M[F]).active=!1;for(H=u=0,f=B.length;u<f;H=++u)l=B[H],(x=I(l))&&(x.active=!0);for(t=[],p=0,g=M.length;p<g;p++)if(!(x=M[p]).active){for(x.prev&&(x.prev.next=x.next),x.next&&(x.next.prev=x.prev),O(x),x.CD.destroy(),d=0,h=($=x.element_list).length;d<h;d++)s=$[d],t.push(s);x.next=null,x.prev=null,x.element_list=null}for(E=null,D=!(a=[]),n=U.element_list.length-1,H=w=0,m=B.length;w<m;H=++w)if(l=B[H],x=I(c=l))if(U.updateLocals(x.CD,l,H,B),x.prev!==E){for((x.prev=E)&&(E.next=x),C=0,b=(P=x.element_list).length;C<b;C++)s=P[C],T.push({element:s,after:L}),L=s;(E=x).active=D=!0,j.push(x)}else{if(D)for(k=0,v=(A=x.element_list).length;k<v;k++)s=A[k],T.push({element:s,after:L}),L=s;L=(E=x).element_list[n],x.active=!0,j.push(x)}else r=U.makeChild(c,H,B),c=function(){for(var e=U.element_list,t=[],n=0,i=e.length;n<i;n++)o=e[n],s=o.cloneNode(!0),a.push({cd:r,el:s}),T.push({element:s,after:L}),t.push(L=s);return t}(),z(l,x={CD:r,element_list:c,prev:E,next:null,active:!0,item:l}),E?(_=E.next,((E.next=x).next=_)&&(_.prev=x)):0===H&&M[0]&&(_=M[0],(x.next=_).prev=x),E=x,j.push(x);for(M=j,U.rawUpdateDom(t,T),t.length=0,S=T.length=0,y=a.length;S<y;S++)i=a[S],Y.bind(i.cd,i.el,{skip_attr:V,elementCanBeRemoved:W.attrName,noDomOptimization:!0})}:function(e){var t,n,i,a,o,r,s,l,c,u,p,d,f,g,h,m,v,b,y,w=R(e),k=U.top_element;for(x++,i=[],m=[],b=null,v=!(t=[]),H=r=0,p=w.length;r<p;H=++r)l=w[H],(h=I(y=l))?(U.updateLocals(h.CD,l,H,w),h.prev!==b?((h.prev=b)&&(b.next=h),i.push({element:h.element,after:k}),v=!0,k=h.element,(b=h).version=x):(v&&i.push({element:h.element,after:b.element}),k=(b=h).element,h.version=x),m.push(h)):(n=U.makeChild(y,H,w),C=U.base_element.cloneNode(!0),null===_?(o=U.base_element.cloneNode(!0),y=Y.bind(n,C,{skip_attr:V,elementCanBeRemoved:W.attrName,noDomOptimization:!0,fbElement:o}),(_=Y.core.fastBinding(y)||!1)&&(U.base_element=o)):t.push({cd:n,el:C}),i.push({element:C,after:k}),z(l,h={CD:n,element:k=C,prev:b,next:null,version:x,item:l}),b?(g=b.next,((b.next=h).next=g)&&(g.prev=h)):0===H&&M[0]&&(g=M[0],(h.next=g).prev=h),b=h,m.push(h));for(a=[],c=0,d=M.length;c<d;c++)(h=M[c]).version!==x&&(h.prev&&(h.prev.next=h.next),h.next&&(h.next.prev=h.prev),O(h),h.CD.destroy(),a.push(h.element),h.next=null,h.prev=null,h.element=null);for(M=m,U.rawUpdateDom(a,i),a.length=0,u=i.length=0,f=t.length;u<f;u++)s=t[u],_?_.bind(s.cd,s.el):Y.bind(s.cd,s.el,{skip_attr:V,elementCanBeRemoved:W.attrName,noDomOptimization:!0})});var n,i,a,O,I,o,M,H,_,x,V,z,r,R}})}},Y.d.al.init=function(t,n,i,a){var o,e,r,s;Y.option.removeAttribute&&(n.removeAttribute(a.attrName),a.fbElement&&a.fbElement.removeAttribute(a.attrName)),o=a.changeDetector,s=["$element"],"window"===a.attrArgument&&s.push("window");try{r=o.compile(i,{no_return:!0,input:s}),a.fastBinding=e=function(e,t,n,i){return r(i.changeDetector.locals,t,window)},e(0,n,0,a)}catch(e){Y.exceptionHandler(e,"al-init, error in expression: "+i,{exp:i,scope:t,cd:o,element:n}),a.fastBinding=function(){}}},Y.d.al.app={stopBinding:!0},Y.d.al.stop={restrict:"AE",stopBinding:!0},Y.d.al.cloak=function(e,t,n,i){t.removeAttribute(i.attrName),n&&ce.removeClass(t,n)},Y.d.al.html={restrict:"AM",priority:100,modifier:{},link:function(a,o,r,s){var l;return s.elementCanBeRemoved&&8!==o.nodeType?(Y.exceptionHandler(null,s.attrName+" can't control element because of "+s.elementCanBeRemoved,{scope:a,element:o,value:r,env:s}),{}):(s.stopBinding=!0,l={baseElement:null,topElement:null,activeElement:null,childCD:null,name:r,watchMode:null,start:function(){l.parsing(),l.prepare(),l.watchModel()},parsing:function(){var e,t,n,i;if(s.attrArgument)for(e=0,t=(i=s.attrArgument.split(".")).length;e<t;e++)"literal"!==(n=i[e])?"tpl"!==n?Y.d.al.html.modifier[n]&&Y.d.al.html.modifier[n](l,{scope:a,element:o,inputName:r,env:s}):l.watchMode="tpl":l.watchMode="literal"},prepare:function(){8===o.nodeType?(l.baseElement=null,l.topElement=o):(l.baseElement=o,l.topElement=document.createComment(" "+s.attrName+": "+r+" "),ce.before(o,l.topElement),ce.remove(o))},removeBlock:function(){var e,t,n,i;if(l.childCD&&(l.childCD.destroy(),l.childCD=null),l.activeElement){if(Array.isArray(l.activeElement))for(t=0,n=(i=l.activeElement).length;t<n;t++)e=i[t],l.removeDom(e);else l.removeDom(l.activeElement);l.activeElement=null}},insertBlock:function(e){var t,n,i;if(l.baseElement)l.activeElement=l.baseElement.cloneNode(!1),l.activeElement.innerHTML=e,l.insertDom(l.topElement,l.activeElement),l.childCD=s.changeDetector.new(),Y.bind(l.childCD,l.activeElement,{skip_attr:s.skippedAttr(),elementCanBeRemoved:s.attrName});else for((i=document.createElement("body")).innerHTML=e,t=l.topElement,l.activeElement=[],l.childCD=s.changeDetector.new();n=i.firstChild;)l.insertDom(t,n),l.activeElement.push(t=n),Y.bind(l.childCD,t,{skip_attr:s.skippedAttr(),elementCanBeRemoved:s.attrName})},updateDom:function(e){l.removeBlock(),e&&l.insertBlock(e)},removeDom:function(e){ce.remove(e)},insertDom:function(e,t){ce.after(e,t)},watchModel:function(){"literal"===l.watchMode?l.updateDom(l.name):"tpl"===l.watchMode?s.watchText(l.name,l.updateDom):s.watch(l.name,l.updateDom)}})}},Y.d.al.html.modifier.id=function(n){return n.updateDom=function(e){var t;n.removeBlock(),(e=document.getElementById(e))&&(t=e.innerHTML)&&n.insertBlock(t)}},Y.d.al.html.modifier.url=function(t){return t.loadHtml=function(e){ce.ajax(e)},t.updateDom=function(e){e?t.loadHtml({cache:!0,url:e,success:function(e){t.removeBlock(),t.insertBlock(e)},error:t.removeBlock}):t.removeBlock()}},Y.d.al.html.modifier.scope=function(i,a){var o,r,e=i.name.split(":");if(2===e.length)i.name=e[0],r=e[1];else{if(e=i.name.match(/(.+)\:\s*\:\:([\d\w]+)$/))o=!0;else if(o=!1,!(e=i.name.match(/(.+)\:\s*([\.\w]+)$/)))throw"Wrong expression "+i.name;i.name=e[1],r=e[2]}return i.insertBlock=function(e){var t,n;i.activeElement=i.baseElement.cloneNode(!1),i.activeElement.innerHTML=e,i.insertDom(i.topElement,i.activeElement),e=a.env.changeDetector,(t=i.childCD=e.new(null,{locals:!0})).locals.outer=null,n=e.watch(r,function(e){return t.locals.outer=e},{oneTime:o}),i.childCD.watch("$destroy",function(){return n.stop()}),Y.bind(i.childCD,i.activeElement,{skip_attr:a.env.skippedAttr()})}},Y.d.al.html.modifier.inline=function(e,t){var n=e.prepare;return e.prepare=function(){return n(),t.env.setValue(e.name,e.baseElement.innerHTML)}},Y.d.al.radio=function(e,t,n,i){var a,o=i.takeAttr("al-value"),r=o?i.eval(o):i.takeAttr("value");return i.on(t,"change",function(){i.setValue(n,r),a.refresh(),i.scan()}),a=i.watch(n,function(e){return t.checked=r===e,"$scanNoChanges"})},window.Map?((oe=function(){return this.idByItem=new Map,this.itemById={},this.index=1,this}).prototype.acquire=function(e){var t="i"+this.index++;return this.idByItem.set(e,t),this.itemById[t]=e,t},oe.prototype.release=function(e){var t=this.itemById[e];delete this.itemById[e],this.idByItem.delete(t)},oe.prototype.replace=function(e,t){var n=this.itemById[e];this.idByItem.delete(n),this.idByItem.set(t,e),this.itemById[e]=t},oe.prototype.getId=function(e){return this.idByItem.get(e)},oe.prototype.getItem=function(e){return this.itemById[e]||null}):((oe=function(){return this.itemById={"i#null":null},this}).prototype.acquire=function(e){var t;return null===e?"i#null":("object"==typeof e?(t=e.$alite_id)||(e.$alite_id=t=Y.utils.getId()):t=""+e,this.itemById[t]=e,t)},oe.prototype.release=function(e){delete this.itemById[e]},oe.prototype.replace=function(e,t){this.itemById[e]=t},oe.prototype.getId=function(e){return null===e?"i#null":"object"==typeof e?e.$alite_id:""+e},oe.prototype.getItem=function(e){return this.itemById[e]||null}),Y.d.al.select=function(e,t,n,i){var a,o,r,s,l,c=i.changeDetector.new();return i.stopBinding=!0,c.$select={mapper:o=new oe},a=null,c.$select.change=function(){return Y.nextTick(function(){return s(a)})},s=function(e){e=o.getId(e);return e?t.value=e:t.selectedIndex=-1},l=c.watch(n,function(e){return s(a=e)}),r=function(e){return a=o.getItem(e.target.value),c.setValue(n,a),l.refresh(),c.scan()},i.on(t,"input",r),i.on(t,"change",r),Y.bind(c,t,{skip_attr:i.skippedAttr()})},Y.d.al.option=function(e,t,n,i){var a,o,r,s,l,i=l=i.changeDetector;for(o=0;o<=4&&!(s=l.$select);++o)l=l.parent||{};s?(r=s.mapper,a=null,i.watch(n,function(e){a?r.getId(e)!==a?(r.release(a),a=r.acquire(e),t.value=a,s.change()):r.replace(a,e):(a=r.acquire(e),t.value=a,s.change())}),i.watch("$destroy",function(){return r.release(a),s.change()})):Y.exceptionHandler("","Error in al-option - al-select is not found",{cd:i,scope:i.scope,element:t,value:n})},Y.hooks.attribute.unshift({code:"attribute",fn:function(){var e=this.attrName.match(/^\:([\w\.\-]+)$/);e&&("html"===(e=e[1]).split(".")[0]?(this.name="html",e=e.substring(5)):this.name="attr",this.ns="al",this.attrArgument=e)}}),re={checked:"checked",readonly:"readOnly",value:"value",selected:"selected",muted:"muted",disabled:"disabled",hidden:"hidden"},Y.d.al.attr=function(e,t,a,n){var o,r,i,s,l,c,u,p,d;if(n.attrArgument){if(i=n.attrArgument.split("."),r=i[0],c=re[r],s=0<i.indexOf("tpl"),Y.option.removeAttribute&&(t.removeAttribute(n.attrName),n.fbElement&&n.fbElement.removeAttribute(n.attrName)),o={readOnly:!0},u=null,"style"===r){if(!i[1])throw"Style is not declared";p=i[1].replace(/(-\w)/g,function(e){return e.substring(1).toUpperCase()}),u=function(e,t){return e.style[p]=t=null==t?"":t}}else"class"===r&&1<i.length?(s=!1,l=i.slice(1),u=function(e,t){var n,i,a,o,r;if(t)for(i=0,o=l.length;i<o;i++)n=l[i],ce.addClass(e,n);else for(a=0,r=l.length;a<r;a++)n=l[a],ce.removeClass(e,n)}):"focus"===r?u=function(e,t){return t?e.focus():e.blur()}:c?u=function(e,t){if(e[c]!==(t=void 0===t?null:t))return e[c]=t}:(o.element=t,o.elementAttr=r);d=s?"watchText":"watch",(s=u?function(e,t,n,i){return i.changeDetector[d](a,function(e){return u(t,e)},o)}:function(e,t,n,i){return i.changeDetector[d](a,null,{readOnly:!0,element:t,elementAttr:r})})(e,t,a,n),n.fastBinding=s}},Y.d.al.model=function(e,t,n,i){var a=t.nodeName.toLowerCase();if("select"===a)return Y.d.al.select.call(this,e,t,n,i);if("input"===a){if("checkbox"===t.type)return Y.d.al.checked.call(this,e,t,n,i);if("radio"===t.type)return Y.d.al.radio.call(this,e,t,n,i)}return Y.d.al.value.call(this,e,t,n,i)},Y.filters.slice=function(e,t,n){return e?n?e.slice(t,n):e.slice(t):null},se=function(e){return e<10?"0"+e:""+e},Y.filters.date=function(e,t){var n,i,a,o,r;if(!e)return"";for(o=t,i=0,a=(r=[[/yyyy/g,(e=new Date(e)).getFullYear()],[/mm/g,se(e.getMonth()+1)],[/dd/g,se(e.getDate())],[/HH/g,se(e.getHours())],[/MM/g,se(e.getMinutes())],[/SS/g,se(e.getSeconds())]]).length;i<a;i++)o=o.replace((n=r[i])[0],n[1]);return o},Y.filters.json={watchMode:"deep",fn:function(e){return JSON.stringify(Y.utils.clone(e),null,4)}},Y.filters.filter=function(e,t,n){var i,a,o,r,s,l,c,u,p,d,f;if(2===arguments.length)s=null,f=t;else{if(3!==arguments.length)return e;s=t,f=n}if(!e||null==f||""===f)return e;if(u=[],p=(""+f).toLowerCase(),s)for(a=0,l=e.length;a<l;a++)((i=e[a])[s]===f||0<=(""+i[s]).toLowerCase().indexOf(p))&&u.push(i);else for(o=0,c=e.length;o<c;o++)for(r in i=e[o])((d=i[r])===f||0<=(""+d).toLowerCase().indexOf(p))&&u.push(i);return u},Y.filters.orderBy=function(e,n,i){return!e instanceof Array?null:(i=i?1:-1,e.sort(function(e,t){return e[n]<t[n]?-i:e[n]>t[n]?i:0}))},Y.filters.throttle={init:function(e,t,n){var i;return t=Number(t),i=null,{onChange:function(e){return i&&clearTimeout(i),i=setTimeout(function(){return i=null,n.setValue(e),n.changeDetector.scan()},t)}}}},Y.filters.toArray={init:function(e,t,a){var o,r=2===a.conf.args.length?(o=a.conf.args[0],a.conf.args[1]):(o="key","value"),s=[];return{watchMode:"deep",onChange:function(e){var t,n,i;for(n in s.length=0,e)i=e[n],(t={})[o]=n,t[r]=i,s.push(t);return a.setValue(s)}}}},Y.filters.storeTo={init:function(e,t,n){return{onChange:function(e){return n.changeDetector.setValue(t,e),n.setValue(e)}}}},Y.text["="]=function(e,t,n,i){t=Y.utils.compile.expression(t);if(t.filters)throw"Conflict: bindonce and filters, use one-time binding";i.finally(t.fn(i.changeDetector.locals))},Y.text["::"]=function(e,t,n,i){i.changeDetector.watch(t,function(e){return i.finally(e)},{oneTime:!0})},le=Y.f$,Y.component=function(C,S){var e,t=C.match(/^(\w+)[\-](.+)$/),t=t?(e=t[1],t[2]):(e="$global",C);t=fe(t),Y.d[e]||(Y.d[e]={}),Y.d[e][t]={restrict:"E",stopBinding:!0,priority:Y.priority.$component,init:function(e,n,t,i){var a={$sendEvent:function(e,t){e=new CustomEvent(e);e.value=t,e.component=!0,n.dispatchEvent(e)}},o=i.changeDetector.new(),r=Y.ChangeDetector(a),s=new A({element:n,attributes:i.attributes,changeDetector:r,parentChangeDetector:o});try{var l=S.call(r,a,n,s)||{}}catch(e){return void Y.exceptionHandler(e,"Error in component <"+C+">: ",{element:n,scope:a,cd:r})}l.onStart&&r.watch("$finishBinding",function(){l.onStart(),r.scan()});var c=!1;o.watch("$destroy",function(){c=!0,r.destroy()}),r.watch("$destroy",function(){l.onDestroy&&l.onDestroy(),c||o.destroy()});for(var u=0,p=n.attributes;u<p.length;u++)if("#"===(y=p[u]).name[0]){var d=y.name.slice(1);if(d){l.api?o.setValue(d,l.api):o.setValue(d,a);break}}function f(e,t){var n=s.takeAttr(":"+e);if(!n){if(!(n=s.takeAttr(e)))return;t="copy"}ge({childCD:r,listener:t,name:e,parentName:n,parentCD:o})}if(l.props)if(Array.isArray(l.props))for(var g=0,h=l.props;g<h.length;g++)f(m=h[g],!0);else for(var m in l.props)f(m,l.props[m]);else for(var v=0,b=n.attributes;v<b.length;v++){var y,w=(y=b[v]).name,k=y.value;k&&((w=w.match(/^\:(.*)$/))&&ge({childCD:r,name:w[1],parentName:k,parentCD:o}))}var _=!1;if(o.watch("$onScanOnce",function(){return _=!0}),l.template&&(n.innerHTML=l.template),l.templateId){i=document.getElementById(l.templateId);if(!i)throw"No template "+l.templateId;n.innerHTML=i.innerHTML}function x(){_||o.digest(),Y.bind(r,n,{skip:!0})}l.templateUrl?le.ajax({url:l.templateUrl,cache:!0,success:function(e){n.innerHTML=e,x()},error:function(){console.error("Template is not loaded",l.templateUrl)}}):x()}}},Y}c.length&&5<m("#the-list tr").length&&!Cookies.get("ipages-page-feedback-hidden")&&c.addClass("ipages-active").find(".ipages-page-feedback-close").on("click",function(e){c.removeClass("ipages-active"),Cookies.set("ipages-page-feedback-hidden",!0,{expires:360})}),(l=u()).makeInstance=u,"function"==typeof alightInitCallback?alightInitCallback(l):"function"==typeof define?define(function(){return l}):"object"==typeof module&&"object"==typeof module.exports?module.exports=l:(l.option.globalController=!0,(window.alight=l).f$.ready(l.bootstrap))}(jQuery);